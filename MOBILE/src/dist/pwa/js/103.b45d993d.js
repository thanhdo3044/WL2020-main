(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[103],{"604a":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"q-pa-md"},[e("div",{staticClass:"row justify-center"},[e("div",{staticClass:"col-8 col-sm-6"},[e("p",{staticClass:"prodTextTitle"},[t._v("BÁO CÁO KHẢO SÁT TỶ LỆ KHUYẾT TẬT SẤY GỖ")])]),e("div",{staticClass:"col-4"},[e("q-btn",{attrs:{color:"secondary",label:"Hoàn thành"},on:{click:function(a){t.confirm=!0}}})],1)]),e("q-separator"),e("div",{staticClass:"row justify-center"},[e("div",{staticClass:"col-12 col-sm-6"},[e("p",{staticClass:"prodTextNormal"},[t._v("\n                Khảo sát cho mẻ sấy : "+t._s(t.kilnBatchId)+"\n            ")]),e("p",{staticClass:"prodTextNormal"},[t._v("\n                Ngày khảo sát : "+t._s((new Date).toISOString().slice(0,10))+"\n            ")]),e("p",{staticClass:"prodTextNormal"},[t._v("\n                Nhà máy :\n            ")]),e("p",{staticClass:"prodTextNormal",staticStyle:{"font-weight":"800"}},[t._v("\n                Tỷ lệ mo , Tóp trung bình  : "+t._s(t.moRate)+" %\n            ")]),e("p",{staticClass:"prodTextNormal",staticStyle:{"font-weight":"800"}},[t._v("\n                Tỷ lệ cong trung bình  : "+t._s(t.congRate)+" %\n            ")]),e("p",{staticClass:"prodTextNormal",staticStyle:{"font-weight":"800"}},[t._v("\n                Tổng khuyết tật  : "+t._s(t.totalKT)+" \n            ")])])]),e("q-separator"),e("div",{staticClass:"row justify-center"},[e("div",{staticClass:"col-12 col-sm-6"},[e("q-card",[e("q-card-section",[e("p",{staticClass:"prodTextTitle"},[t._v("Nhập thông tin khảo sát")])]),e("q-separator"),e("q-card-section",[e("q-input",{attrs:{clearable:"",type:"number",outlined:"",label:"Số pallet"},model:{value:t.palletCode,callback:function(a){t.palletCode=t._n(a)},expression:"palletCode"}}),e("br"),e("q-input",{attrs:{clearable:"",type:"number",outlined:"",label:"Số lượng mẫu"},model:{value:t.sampleQty,callback:function(a){t.sampleQty=t._n(a)},expression:"sampleQty"}}),e("br"),e("q-input",{attrs:{clearable:"",type:"number",outlined:"",label:"SL Mo,Tóp"},model:{value:t.moTopQty,callback:function(a){t.moTopQty=t._n(a)},expression:"moTopQty"}}),e("br"),e("q-input",{attrs:{clearable:"",type:"number",outlined:"",label:"SL Cong"},model:{value:t.congQty,callback:function(a){t.congQty=t._n(a)},expression:"congQty"}}),e("br"),e("q-input",{attrs:{outlined:"",clearable:"",type:"textarea"},model:{value:t.note,callback:function(a){t.note=a},expression:"note"}}),e("br"),e("q-btn",{staticClass:"full-width",attrs:{color:"deep-orange",glossy:"",label:"Ghi nhận"},on:{click:t.add}})],1)],1)],1)]),e("div",{staticClass:"row justify-center "},t._l(t.dataKT.record,(function(a,s){return e("div",{key:s,staticClass:"col-12 col-sm-3 q-ma-sm"},[e("q-card",{staticClass:"bg-secondary text-white"},[e("q-card-section",[e("p",{staticClass:"prodTextNormal"},[t._v("Số plallet : "+t._s(a.palletCode)+" ")]),e("p",{staticClass:"prodTextNormal"},[t._v("SL mẫu : "+t._s(a.sampleQty))]),e("p",{staticClass:"prodTextNormal"},[t._v("SL mo, Tóp: "+t._s(a.moTopQty))]),e("p",{staticClass:"prodTextNormal"},[t._v("SL Cong : "+t._s(a.congQty))]),e("p",{staticClass:"prodTextNormal"},[t._v("Tỷ lệ mo, Tóp : "+t._s((a.moTopQty/a.sampleQty*100).toFixed(2))+" %")]),e("p",{staticClass:"prodTextNormal"},[t._v("Tỷ lệ cong : "+t._s((a.congQty/a.sampleQty*100).toFixed(2))+" %")]),e("p",{staticClass:"prodTextNormal"},[t._v("Ghi chú :"+t._s(a.note))])])],1)],1)})),0),e("q-dialog",{attrs:{persistent:""},model:{value:t.confirm,callback:function(a){t.confirm=a},expression:"confirm"}},[e("q-card",{staticStyle:{"min-width":"300px"}},[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"prodTextTitle"},[t._v("Bạn đã chắc chắn !.")])]),e("q-separator"),e("q-card-section",[e("p",{staticClass:"prodTextNormal"},[t._v("- Dữ liệu được lưu lại tự động ")]),e("p",{staticClass:"prodTextNormal"},[t._v('- Sau khi hoàn thành biên bản sẽ không thể chỉnh sửa "Hãy cân nhắc"')])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy",color:"primary"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đồng ý",color:"primary"},on:{click:t.save}})],1)],1)],1)],1)},o=[],n=e("a34a"),l=e.n(n),i=(e("96cf"),e("c973")),c=e.n(i),r=(e("6b54"),e("06db"),e("f79b")),p={data:function(){return{palletCode:"",sampleQty:"",moTopQty:"",congQty:"",dataKT:{},kilnBatchId:null,note:"",moRate:0,congRate:0,totalKT:0,confirm:!1}},watch:{},created:function(){this.kilnBatchId=this.$route.params.kinlbatchid;var t=localStorage.getItem("kt"+this.kilnBatchId);if(null!==t&&void 0!==t&&"null"!==t.toString()){var a=JSON.parse(t);this.dataKT=a,this.dataKT&&this.calRate()}else this.dataKT={type:r["a"].BB_KHAO_SAT_KHUYET_TAT_LO_SAY,linkId:this.kilnBatchId,linkType:"kilnBatch",record:[]}},methods:{calRate:function(){var t=this;this.moRate=0,this.congRate=0,this.totalKT=0;var a=[],e=[];this.dataKT.record.forEach((function(s){a.push(s.moTopQty),e.push(s.congQty),t.totalKT+=s.moTopQty+s.congQty}));var s=function(t){return t.reduce((function(t,a){return t+a}),0)/t.length};this.moRate=s(a).toFixed(2),this.congRate=s(e).toFixed(2),this.dataKT.congRate=this.congRate,this.dataKT.moRate=this.moRate,this.dataKT.totalKT=this.totalKT},save:function(){var t=this;return c()(l.a.mark((function a(){var e;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!(t.dataKT.record.length>0)){a.next=13;break}if(!navigator.onLine){a.next=10;break}return t.$q.loading.show(),a.next=5,t.$store.dispatch("production/ACTION_CREATE_BB_KT",t.dataKT);case 5:e=a.sent,t.$q.loading.hide(),!0===e.meta.success?(t.$q.notify({message:"Lưu biên bản thành công !",color:"green"}),localStorage.setItem("kt"+t.kilnBatchId,null),t.$router.go(-1)):t.$q.notify({message:e.meta.messages.message,color:"red"}),a.next=11;break;case 10:t.$q.notify({message:"Không có kết nối Internet !",color:"red"});case 11:a.next=14;break;case 13:t.$q.notify({message:"Biên bản chưa cố dữ liệu !",color:"red"});case 14:case"end":return a.stop()}}),a)})))()},add:function(){if(this.palletCode&&this.congQty&&this.moTopQty&&this.sampleQty){var t={palletCode:this.palletCode,sampleQty:this.sampleQty,moTopQty:this.moTopQty,congQty:this.congQty,note:this.note};this.dataKT.record.push(t),this.calRate(),this.$q.notify({message:"Đã thêm dữ liệu !",color:"green"}),localStorage.setItem("kt"+this.kilnBatchId,JSON.stringify(this.dataKT)),this.moTopQty="",this.congQty=""}else this.$q.notify({message:"Vui lòng điền đầy đủ thông tin !",color:"red"})}}},d=p,h=e("2877"),m=e("9989"),u=e("9c40"),T=e("eb85"),g=e("f09f"),y=e("a370"),f=e("27f9"),b=e("24e8"),v=e("4b7e"),C=e("7f67"),_=e("eebe"),Q=e.n(_),x=Object(h["a"])(d,s,o,!1,null,null,null);a["default"]=x.exports;Q()(x,"components",{QPage:m["a"],QBtn:u["a"],QSeparator:T["a"],QCard:g["a"],QCardSection:y["a"],QInput:f["a"],QDialog:b["a"],QCardActions:v["a"]}),Q()(x,"directives",{ClosePopup:C["a"]})}}]);