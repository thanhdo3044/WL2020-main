(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{"08bb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("order-header",{attrs:{order:e.order}}),a("q-card",{staticClass:"my-card"},[a("CapBaoHoLaoDong",{attrs:{order:e.order,metaValue:e.metaValue,disable:e.disable}})],1),a("q-card",[a("q-card-section",[e.order.Requests&&!Object.keys(e.order.Requests).length||void 0==e.order.Requests?a("q-checkbox",{attrs:{label:"Đồng ý"},model:{value:e.disable,callback:function(t){e.disable=t},expression:"disable"}}):e._e()],1)],1),e.disable?a("order-approved",{attrs:{metaValue:e.metaValue,selection:e.metaValue.selection,order:e.order}}):e._e(),a("send-message",{attrs:{order:e.order}})],1)},n=[],o=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("f751"),a("9523")),s=a.n(o),d=a("2f62"),i=a("932a"),l=a("6664"),u=a("0ac8"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card-section",[a("div",{staticClass:"q-gutter-sm text-primary text-h6"},[e._v("\n      Chọn loại mẫu đề nghị :\n      "),a("br")]),a("div",{staticClass:"q-gutter-sm q-mt-sm"},[null==e.order.OrderMeta[0].selection?a("div",[a("q-radio",{attrs:{dense:"",val:"Đề xuất cấp bảo hộ lao động",label:"Đề xuất cấp bảo hộ lao động",color:"teal"},model:{value:e.metaValue.selection,callback:function(t){e.$set(e.metaValue,"selection",t)},expression:"metaValue.selection"}})],1):a("div",["Đề xuất cấp bảo hộ lao động"==e.order.OrderMeta[0].selection?a("span",[a("q-radio",{attrs:{dense:"",val:"Đề xuất cấp bảo hộ lao động",color:"red"},model:{value:e.metaValue.selection,callback:function(t){e.$set(e.metaValue,"selection",t)},expression:"metaValue.selection"}})],1):e._e(),a("span",{staticClass:"q-ml-sm",staticStyle:{"font-size":"20px"}},[e._v(e._s(e.metaValue.selection))])])]),"Đề xuất cấp bảo hộ lao động"==e.metaValue.selection?a("div",["Không được duyệt"==e.order.status?a("div",[a("q-input",{staticClass:"q-mt-sm",attrs:{outlined:"",label:"Bộ phận/phòng ban : ",readonly:e.disable},model:{value:e.nameDepartmentName.NAME,callback:function(t){e.$set(e.nameDepartmentName,"NAME",t)},expression:"nameDepartmentName.NAME"}}),a("DxDataGrid",{attrs:{id:"gridContainer","data-source":e.order.OrderMeta,"allow-column-reordering":!0,"show-borders":!0,"key-expr":"id"},on:{"init-new-row":e.initNewRow,"row-inserted":e.RowInserted,"row-updated":e.RowUpdated,"row-removed":e.RowDelted}},[a("DxPaging",{attrs:{enabled:!0}}),a("DxEditing",{attrs:{"allow-updating":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-deleting":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-adding":!e.order.Requests.length||"Không được duyệt"==e.order.status,mode:"row"}}),a("DxColumn",{attrs:{"data-field":"STT",caption:"STT"}}),a("DxColumn",{attrs:{caption:"Tên bảo hộ lao động","data-field":"Tenbaoho"}}),a("DxColumn",{attrs:{caption:"Quy cách","data-field":"quyCach"}}),a("DxColumn",{attrs:{caption:"ĐVT","data-field":"donViTinh"}}),a("DxColumn",{attrs:{"data-field":"soLuongDeXuat",caption:"Số lượng đề xuất","data-type":"number"}}),a("DxColumn",{attrs:{"data-field":"soLuongCap",caption:"Số lượng cấp","data-type":"number"}}),a("DxColumn",{attrs:{"data-field":"description",caption:"Ghi chú"}})],1),a("q-btn",{staticClass:"q-mt-sm",attrs:{color:"primary","text-color":"white",label:"Sửa"},on:{click:e.updatedOrderMeta}})],1):a("div",[a("q-input",{staticClass:"q-mt-sm",attrs:{outlined:"",label:"Bộ phận/phòng ban : ",readonly:e.disable},model:{value:e.nameDepartmentName.NAME,callback:function(t){e.$set(e.nameDepartmentName,"NAME",t)},expression:"nameDepartmentName.NAME"}}),a("DxDataGrid",{attrs:{id:"gridContainer","data-source":e.order.OrderMeta,"allow-column-reordering":!0,"show-borders":!0,"key-expr":"id"},on:{"init-new-row":e.initNewRow,"row-inserted":e.RowInserted,"row-updated":e.RowUpdated,"row-removed":e.RowDelted}},[a("DxPaging",{attrs:{enabled:!0}}),a("DxEditing",{attrs:{"allow-updating":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-deleting":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-adding":!e.order.Requests.length||"Không được duyệt"==e.order.status,mode:"row"}}),a("DxColumn",{attrs:{"data-field":"STT",caption:"STT"}}),a("DxColumn",{attrs:{caption:"Tên bảo hộ lao động","data-field":"Tenbaoho"}}),a("DxColumn",{attrs:{caption:"Quy cách","data-field":"quyCach"}}),a("DxColumn",{attrs:{caption:"ĐVT","data-field":"donViTinh"}}),a("DxColumn",{attrs:{"data-field":"soLuongDeXuat",caption:"Số lượng đề xuất","data-type":"number"}}),a("DxColumn",{attrs:{"data-field":"soLuongCap",caption:"Số lượng cấp","data-type":"number"}}),a("DxColumn",{attrs:{"data-field":"description",caption:"Ghi chú"}})],1)],1)]):e._e()])},p=[],m=(a("6b54"),a("a34a")),g=a.n(m),h=(a("96cf"),a("c973")),b=a.n(h),f=a("6191"),O=a.n(f),D=a("bc3a"),w=a.n(D),x=a("d30a");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={components:{DxDataGrid:x["DxDataGrid"],DxColumn:x["DxColumn"],DxEditing:x["DxEditing"],DxPaging:x["DxPaging"],DxButton:O.a,DxLookup:x["DxLookup"]},props:["metaValue","disable","order"],created:function(){var e=this;return b()(g.a.mark((function t(){return g.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.GET_DEPARTMENTSBYID(e.userInfo.department);case 2:e.nameDepartmentName=t.sent,console.log(e.metaValue.selection),e.status=e.$route.query.status,e.$route.query.id?e.getOneOrder(e.$route.query.id).then((function(t){t.data.data.Requests.length&&(e.disable=!0),e.metaValue=Object.assign(e.metaValue,JSON.parse(t.data.data.OrderMeta[0].metaValue)[0])})):e.$router.push({path:"/tao-de-xuat"});case 6:case"end":return t.stop()}}),t)})))()},data:function(){return s()({events:[],nameDepartment:{},status:"",phoneNumber:""},"nameDepartment",null)},computed:y(y({},Object(d["c"])("orders",["order"])),Object(d["c"])("base",["userInfo","dsCongDoans"])),methods:y(y(y(y(y({},Object(d["b"])("base",["GET_DEPARTMENTSBYID"])),Object(d["b"])("orders",["getOneOrder","getAllRequests"])),Object(d["b"])("orderMetas",["getOneOrderMeta","addorderMeta","deleteOrderMeta","updateOrderMeta"])),Object(d["b"])("requests",["deleteRequest","resetOrder"])),{},{loadData:function(e){var t=this;return b()(g.a.mark((function a(){var r;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=null,a.prev=1,a.next=4,t.getOneOrder(e);case 4:r=a.sent,a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](1),console.log(a.t0);case 10:r||t.$router.push({path:"/tao-de-xuat"}),t.order=r.data.data,console.log(r);case 13:case"end":return a.stop()}}),a,null,[[1,7]])})))()},RowInserted:function(e){var t=this;return b()(g.a.mark((function a(){var r,n,o,s,d,i,l,u,c,p,m;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("STT",e.data.STT),console.log("STT",e.data.id),console.log(t.metaValue.selection),r=e.data.STT,n=e.data.quyCach,o=e.data.soLuongDeXuat,s=e.data.soLuongCap,d=e.data.donViTinh,i=t.userInfo.lastName,l=e.data.Tenbaoho,u=t.userInfo.PHONE,c=t.metaValue.selection,p=e.data.description,m=t.nameDepartmentName.NAME.toString(),a.next=16,t.addorderMeta(y(y({},t.order.OrderMeta[0]),{},{metaValue:JSON.stringify([t.metaValue]),quyCach:n,soLuongDeXuat:o,selection:c,STT:r,soLuongCap:s,fullName:i,description:p,donViTinh:d,phoneNumber:u,department:m,Tenbaoho:l}));case 16:return a.next=18,t.loadData(t.$route.query.id);case 18:case"end":return a.stop()}}),a)})))()},RowDelted:function(e){var t=this;return b()(g.a.mark((function a(){return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("STT",e.data.STT),console.log("STT",e.data.id),a.next=4,t.deleteOrderMeta(e.data.id);case 4:case"end":return a.stop()}}),a)})))()},RowUpdated:function(e){var t=this;return b()(g.a.mark((function a(){var r,n,o,s,d,i,l,u,c,p,m;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("STT",e.data.STT),console.log("STT",e.data.id),r=e.data.STT,n=e.data.quyCach,o=e.data.soLuongDeXuat,s=e.data.soLuongCap,d=e.data.donViTinh,i=t.userInfo.lastName,l=e.data.Tenbaoho,u=t.userInfo.PHONE,c=e.data.description,p=t.metaValue.selection,m=t.nameDepartmentName.NAME.toString(),a.next=15,t.updateOrderMeta(y(y({},t.order.OrderMeta[0]),{},{metaValue:JSON.stringify([t.metaValue]),quyCach:n,soLuongDeXuat:o,selection:p,STT:r,soLuongCap:s,fullName:i,description:c,donViTinh:d,phoneNumber:u,department:m,Tenbaoho:l}));case 15:return a.next=17,t.loadData(t.$route.query.id);case 17:case"end":return a.stop()}}),a)})))()},updatedOrderMeta:function(){var e=this;return b()(g.a.mark((function t(){return g.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.a.put("/api/v2/orders?orderId=".concat(e.order.id));case 2:return t.next=4,e.deleteRequest(e.order.id);case 4:location.reload();case 5:case"end":return t.stop()}}),t)})))()},initNewRow:function(e){var t=e.data;console.log("vao initNewRow"),Object.assign(t,{STT:this.order.OrderMeta.length+1})}})},C=v,q=a("2877"),S=a("a370"),N=a("3786"),j=a("27f9"),V=a("9c40"),M=a("eebe"),R=a.n(M),k=Object(q["a"])(C,c,p,!1,null,null,null),E=k.exports;function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}R()(k,"components",{QCardSection:S["a"],QRadio:N["a"],QInput:j["a"],QBtn:V["a"]});var $={data:function(){var e;return{disable:!1,metaValue:(e={kinhGui:"Ban TGĐ - Trưởng phòng/phó phòng ban :  -\tGĐSX/Phó GĐSX/Phụ trách nhà máy :",noiDungTT:"",soTien:0,vietBangChu:"",kemTheo:"",STT:"12",locationWork:"",position:"",position2:"",number:"",timeRecruit:"",description:"",fullName:"",fullName2:"",maNV:"",department:"",department2:"",stepDepartment:"",lyDo:"",dateStart:"",dateEnd:"",selection1:null,selection2:null,selection3:null,selection4:null,selection:null,thoiGianMangThai:"",xinRaCong:"",quyCach:"",dvt:"",soLuongDeXuat:"",soLuongCap:""},s()(e,"quyCach",""),s()(e,"Tenbaoho",""),e)}},components:{SendMessage:i["a"],OrderHeader:l["a"],OrderApproved:u["a"],CapBaoHoLaoDong:E},methods:L(L({},Object(d["b"])("orders",["getOneOrder","getAllRequests"])),Object(d["b"])("orderMetas",["getOneOrderMeta","addorderMeta"])),computed:L(L({},Object(d["c"])("orders",["order"])),Object(d["c"])("base",["userInfo","myFactoryInfor"])),created:function(){var e=this;this.$route.query.id?this.getOneOrder(this.$route.query.id).then((function(t){t.data.data.Requests.length&&(e.disable=!0),e.metaValue=Object.assign(e.metaValue,JSON.parse(t.data.data.OrderMeta[0].metaValue)[0])})):this.$router.push({path:"/tao-de-xuat"})}},I=$,A=a("9989"),G=a("f09f"),_=a("8f8e"),B=Object(q["a"])(I,r,n,!1,null,null,null);t["default"]=B.exports;R()(B,"components",{QPage:A["a"],QCard:G["a"],QCardSection:S["a"],QCheckbox:_["a"]})}}]);