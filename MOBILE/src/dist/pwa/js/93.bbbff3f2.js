(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[93],{"31f2":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-pa-md"},[a("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrolled,expression:"scrolled"}]},[a("app-bar",[t._v("Tìm kiếm thông tin pallet")]),a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-card",{staticClass:"q-pa-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("p",{staticClass:"prodTextTitle"},[t._v("Nhận pallet")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-8 q-pa-xs"},[a("q-input",{ref:"self1",attrs:{clearable:"",outlined:"",label:"Số pallet"},on:{clear:t.clearCode},model:{value:t.palletCode,callback:function(e){t.palletCode=t._n(e)},expression:"palletCode"}})],1),t.showButtonCheck?a("div",{staticClass:"col-4 q-pa-xs"},[a("q-btn",{staticClass:"full-width",staticStyle:{height:"100%"},attrs:{label:"Kiểm tra",stack:"",glossy:"",color:"blue"},on:{click:t.check}})],1):a("div",{staticClass:"col-4 q-pa-sm justify-center"},[a("q-spinner-ios",{attrs:{color:"primary",size:"4em"}})],1)])])],1)]),t.showFakeKeyboard?a("div",{staticClass:"row justify-center q-mt-md"},[a("div",{staticClass:"col-12 col-sm-6"},[a("div",{staticClass:"row justify-center",staticStyle:{"text-align":"center"}},t._l(12,(function(e){return a("div",{key:e,staticClass:"col-4 q-ms-sm"},[e<10?a("div",{staticClass:"fakeKeyboard",on:{click:function(a){return t.inputCode(e)}}},[t._v(t._s(e))]):t._e(),11===e?a("div",{staticClass:"fakeKeyboard",on:{click:function(e){return t.inputCode(0)}}},[t._v("0")]):t._e(),10===e?a("div",{staticClass:"fakeKeyboard",staticStyle:{"background-color":"#f5a278"},on:{click:t.backspace}},[a("q-icon",{staticStyle:{"font-size":"32px"},attrs:{name:"backspace"}})],1):t._e(),12===e?a("div",{staticClass:"fakeKeyboard",staticStyle:{"background-color":"red"},on:{click:t.clearCode}},[t._v("Xóa")]):t._e()])})),0)])]):t._e(),t.showDetail?a("div",[a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-sm-6"},[t.showButtonConfirm&&""===t.toStep.package.find((function(e){return e.destinationId===t.toStep.stepNextId})).verifyBy?a("div",{staticClass:"row q-ma-sm"},[a("q-btn",{staticClass:"full-width",staticStyle:{height:"100%"},attrs:{label:"Nhận pallet",stack:"",glossy:"",color:"secondary"},on:{click:function(e){t.showDialog=!0}}})],1):a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showPendingConfirm,expression:"showPendingConfirm"}],staticClass:"col-12 q-pa-sm",staticStyle:{"text-align":"center"}},[a("q-spinner-ios",{attrs:{color:"primary",size:"4em"}})],1)]),a("div",{staticClass:"row q-mt-sm"},[a("div",{staticClass:"col-9 prodTextTitle",staticStyle:{color:"orange"}},[t._v("Thông tin pallet "+t._s(t.pallet.code))]),a("div",{staticClass:"col-3",attrs:{align:"right"}},[a("a",{attrs:{id:"viber_share"}},[t._v("Share Viber")])])]),void 0!==t.pallet.item&&t.pallet.item.length>1?a("div",{staticClass:"row"},t._l(t.pallet.item,(function(e){return a("div",{key:e.id,staticClass:"col-12 col-md-6 q-mt-md"},[a("q-card",{staticClass:"my-card",staticStyle:{"min-width":"100%"}},[a("q-card-section",[a("p",{staticClass:"prodTextTitle"},[t._v(t._s(e.name||"????"))]),a("p",{staticClass:"prodTextTitle"},[t._v("(QC: "+t._s(e.height+" "+e.width+" "+e.length)+")")]),a("div",{staticClass:"text-subtitle2"},[t._v("Số lượng : "+t._s(e.quantity)+" ("+t._s(e.unit.name||"Thanh")+")")])])],1)],1)})),0):a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12"},[a("q-card",{staticClass:"my-card q-mt-md",staticStyle:{"min-width":"100%"}},[a("q-card-section",[a("div",{staticClass:"prodTextTitle"},[t._v(t._s(t.pallet.item[0].name||"????")+" (QC: "+t._s(t.pallet.item[0].height+" "+t.pallet.item[0].width+" "+t.pallet.item[0].length)+")")]),a("div",{staticClass:"text-subtitle2"},[t._v("Số lượng : "+t._s(t.pallet.inventory)+" ("+t._s(t.pallet.item[0].unit.name||"Thanh")+")")])])],1)],1)])]),a("div",{staticClass:"col-12 col-sm-6 q-ma-sm"},[a("table-coc")],1),a("div",{staticClass:"col-12 col-sm-6 q-ma-sm"},[a("q-card",{staticClass:"my-card q-pa-xs"},[a("q-card-section",[a("div",{staticClass:"prodTextTitle"},[t._v("Thông tin các công đoạn đã qua")])]),t._l(t.pallet.step,(function(e,s){return a("div",{key:e.id},[s>0?a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("q-chip",[a("q-avatar",{attrs:{color:"blue"}},[t._v(t._s(s+1))]),a("div",{staticClass:"prodTextTitle"},[t._v(t._s(e.stepName))])],1)],1)])])],1):t._e(),s>0?a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"prodTextTitle",staticStyle:{"background-color":"#52f783",padding:"10px"}},[t._v("SL đạt : "+t._s(e.pass))])]),a("div",{staticClass:"col-6"},[a("div",{staticClass:"prodTextTitle",staticStyle:{"background-color":"#faa652",padding:"10px"}},[t._v("SL lỗi : "+t._s(e.notPass))])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[t._v("Ngày làm việc : "+t._s(e.package[0].createDate||"???"))])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[t._v("Người làm : "+t._s(e.package[0].createName||"???"))])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[t._v("Xuất đến : "+t._s(e.stepNextName||"????"))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.package[0].verifyName,expression:"step.package[0].verifyName"}],staticClass:"row"},[a("div",{staticClass:"col-12"},[t._v("Nhận bởi : "+t._s(e.package[0].verifyName||"????"))])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[t._v("Ngày nhận : "+t._s(e.package[0].verifyDate||"Chưa nhận"))])])]):t._e(),a("q-separator")],1)}))],2)],1)])]):t._e(),a("event-log",{attrs:{events:t.events,goDetail:t.goDetail}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm prodTextTitle"},[t._v("Bạn đã chắc chắn ? !")])]),a("q-card-section",{staticStyle:{"font-family":"'Time New Roman'"}},[t._v("Nhận pallet "+t._s(t.pallet.code)+" về công đoạn "+t._s(t.toStep.stepNextName))]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy",color:"primary"}}),a("q-btn",{attrs:{flat:"",label:"Đồng Ý",color:"primary"},on:{click:t.recive}})],1)],1)],1)],1)])},i=[],l=(a("7514"),a("a34a")),o=a.n(l),c=(a("20d6"),a("96cf"),a("c973")),n=a.n(c),r=(a("6b54"),a("06db"),a("889c")),d=a("dd38"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-center q-ma-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-card",[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-8"},[a("div",{staticClass:"prodTextTitle"},[t._v("\n                          Lịch sử\n                      ")])]),t.events.length>0?a("div",{staticClass:"col-4",attrs:{align:"right"}},[a("q-btn",{staticStyle:{color:"#FF0080"},attrs:{flat:"",label:"Xóa lịch sử"},on:{click:t.clearLog}})],1):t._e()])]),a("q-separator"),a("q-card-section",[a("q-markup-table",{attrs:{separator:"cell"}},[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("Thời gian")]),a("th",{staticClass:"text-left"},[t._v("Sự kiện")]),a("th",{staticClass:"text-right"},[t._v("Số pallet")]),a("th",{staticClass:"text-center"},[t._v("Loại pallet")]),a("th",{staticClass:"text-right"},[t._v("Trạng thái")])])]),a("tbody",t._l(t.events,(function(e,s){return a("tr",{key:s,class:"Nhận Pallet"===e.eventName?"bg-indigo-8":"bg-teal"},[a("td",{staticClass:"text-left"},[t._v(t._s(e.timeStamp))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.eventName))]),a("td",{staticClass:"text-right"},[a("q-badge",{attrs:{color:"blue"},on:{click:function(a){return t.goDetail(e.palletCode)}}},[t._v("\n                                  "+t._s(e.palletCode)+" \n                              ")])],1),a("td",{staticClass:"text-center"},[t._v(t._s(e.palletType))]),a("td",{staticClass:"text-right"},[t._v(t._s(1===e.status?"Thành công ":"Thất bại"))])])})),0)])],1)],1)],1)])},h=[],v={props:{events:{type:Array},goDetail:{type:Function}},methods:{clearLog:function(){console.log("aa"),localStorage.removeItem("eventlog"),this.$root.$emit("reload-event-log",!0)}}},u=v,m=a("2877"),C=a("f09f"),g=a("a370"),f=a("9c40"),_=a("eb85"),w=a("2bb1"),b=a("58a8"),y=a("eebe"),k=a.n(y),q=Object(m["a"])(u,p,h,!1,null,null,null),S=q.exports;k()(q,"components",{QCard:C["a"],QCardSection:g["a"],QBtn:f["a"],QSeparator:_["a"],QMarkupTable:w["a"],QBadge:b["a"]});var x=a("1c16"),T={components:{"table-coc":r["a"],"app-bar":d["a"],"event-log":S},meta:function(){return{title:this.title}},data:function(){return{title:"Chi tiết pallet ",palletCode:"",showButtonCheck:!0,pallet:{},showDetail:!1,showButtonConfirm:!1,mySources:[],showDialog:!1,toStep:{},showPendingConfirm:!1,stepTarget:{},path:null,showFakeKeyboard:!0,events:[]}},created:function(){var t=this;this.$root.$on("reload-event-log",(function(){t.events=[]})),this.initEventLog();var e=this.$route.query.code,a=this.$route.query.path;if(a&&(this.path=a),e&&8===e.length){this.title+=" số "+e,this.palletCode=e;var s={token:this.$store.state.base.userInfo.token,palletCode:e.trim()};this.loaData(s)}this.mySources=this.$store.getters["base/mySources"]},methods:{scrolled:Object(x["a"])((function(t){}),200),backspace:function(){this.palletCode.length>0&&(this.palletCode=this.palletCode.toString().slice(0,-1))},initButtonShareViber:function(){var t=window.location.href;"rd"===t.toString().slice(t.length-2)&&(t+="?code="+this.palletCode);var e="viber_share",a="Chi tiết pallet số "+this.palletCode+" :";document.getElementById(e).setAttribute("href","https://3p3x.adj.st/?adjust_t=u783g1_kw9yml&adjust_fallback=https%3A%2F%2Fwww.viber.com%2F%3Futm_source%3DPartner%26utm_medium%3DSharebutton%26utm_campaign%3DDefualt&adjust_campaign=Sharebutton&adjust_deeplink="+encodeURIComponent("viber://forward?text="+encodeURIComponent(a+" "+t)))},initEventLog:function(){var t=localStorage.getItem("eventlog");if(t){var e=JSON.parse(t);this.events=e}},goDetail:function(t){this.palletCode=t,this.scrolled(100),this.$q.notify({message:"Đang kiểm tra pallet "+t,position:"center",color:"cyan",timeout:500}),this.check()},clearCode:function(){this.$refs.self1.blur(),this.showFakeKeyboard=!0,this.palletCode=""},loaData:function(t){var e=this;return n()(o.a.mark((function a(){var s,i;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.showFakeKeyboard=!1,e.title+=" số "+t.palletCode,a.next=4,e.$store.dispatch("production/ACTION_GET_DETAIL_PALLET",t);case 4:s=a.sent,!0===s.meta.success?(e.$root.$emit("reload"),e.pallet=s.data,e.showButtonCheck=!0,e.showDetail=!0,i=s.data.step.slice(-1).pop(),e.stepTarget=i,e.toStep=s.data.step.slice(-1).pop(),-1!==e.$store.getters["base/mySources"].findIndex((function(t){return t.id===i.stepNextId}))&&(e.showButtonConfirm=!0,e.showFakeKeyboard=!1),setTimeout((function(){e.initButtonShareViber()}),300)):(e.showButtonCheck=!0,e.showFakeKeyboard=!0);case 6:case"end":return a.stop()}}),a)})))()},recive:function(){var t=this;return n()(o.a.mark((function e(){var a,s,i,l;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showDialog=!1,t.showButtonConfirm=!1,t.showPendingConfirm=!0,a=t.toStep.package.find((function(e){return e.destinationId==t.stepTarget.stepNextId})),s={token:t.$store.state.base.userInfo.token,packageId:a.id},e.next=7,t.$store.dispatch("production/ACTION_RECIVED_PALLET",s);case 7:i=e.sent,!0===i.meta.success?(t.$q.notify({message:"Đã nhận pallet về công đoạn "+t.toStep.stepNextName,color:"green"}),l={eventName:"Nhận pallet",timeStamp:(new Date).toISOString(),status:1,palletCode:t.palletCode},t.$eventLog(l),t.initEventLog(),t.showPendingConfirm=!1,t.path&&t.$router.push("/"+t.path)):(t.$q.notify({message:i.meta.messages.message,color:"red"}),t.showButtonConfirm=!0,t.showPendingConfirm=!1);case 9:case"end":return e.stop()}}),e)})))()},inputCode:function(t){null===this.palletCode&&(this.palletCode=""),this.palletCode+=t.toString()},check:function(){if(8===this.palletCode.toString().length){this.showButtonCheck=!1;var t={palletCode:this.palletCode};this.loaData(t)}else this.$q.notify({message:"Số pallet không chính xác !",color:"red"})}}},N=T,D=a("9989"),I=a("27f9"),$=a("d9b2"),Q=a("0016"),B=a("cb32"),j=a("66e5"),L=a("4074"),F=a("b047"),P=a("24e8"),E=a("4b7e"),K=a("4396"),A=a("7f67"),O=Object(m["a"])(N,s,i,!1,null,null,null);e["default"]=O.exports;k()(O,"components",{QPage:D["a"],QCard:C["a"],QInput:I["a"],QBtn:f["a"],QSpinnerIos:$["a"],QIcon:Q["a"],QAvatar:B["a"],QCardSection:g["a"],QItem:j["a"],QItemSection:L["a"],QChip:F["a"],QSeparator:_["a"],QDialog:P["a"],QCardActions:E["a"]}),k()(O,"directives",{Scroll:K["a"],ClosePopup:A["a"]})}}]);