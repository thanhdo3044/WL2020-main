(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0cb7e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[r("q-btn",{directives:[{name:"go-back",rawName:"v-go-back.single",modifiers:{single:!0}}],staticClass:"q-ml-sm q-mt-sm bg-orange text-white shadow-5",attrs:{size:"12px",icon:"arrow_back",push:"",label:"Quay lại"}}),r("q-card",{staticClass:"q-pa-sm q-ma-sm shadow-10"},[r("q-tree",{attrs:{nodes:e.customize,"node-key":"label","selected-color":"primary","default-expand-all":""},scopedSlots:e._u([{key:"default-header",fn:function(t){return[r("div",{staticClass:"row items-center"},[r("q-icon",{staticClass:"q-mr-sm",attrs:{name:t.node.icon||"share",color:"orange",size:"28px"}}),r("div",{staticClass:"text-weight-bold text-primary"},[e._v("\n            "+e._s(t.node.label)+"\n          ")])],1)]}},{key:"header-generic",fn:function(t){return[r("div",{staticClass:"row items-center"},[r("q-icon",{staticClass:"q-mr-sm",attrs:{name:t.node.icon||"star ",color:"orange",size:"28px"}}),r("div",{staticClass:"text-weight-bold text-primary",on:{click:function(r){return e.themDeXuat(t)}}},[e._v("\n            "+e._s(t.node.label)+"\n          ")])],1)]}},{key:"body-story",fn:function(t){return[r("span",{staticClass:"text-weight-thin"},[e._v("The story is:")]),e._v("\n        "+e._s(t.node.story)+"\n      ")]}},{key:"body-toggle",fn:function(t){return[r("p",{staticClass:"text-caption"},[e._v(e._s(t.node.caption))]),r("q-toggle",{attrs:{label:"I agree to the terms and conditions"},model:{value:t.node.enabled,callback:function(r){e.$set(t.node,"enabled",r)},expression:"prop.node.enabled"}})]}}])})],1),r("q-btn",{staticClass:"bg-primary q-ml-sm text-white q-mb-sm shadow-5",attrs:{push:"",id:"active",label:"Lịch sử hoàn thành phê duyệt"},on:{click:e.activeHistory}}),r("div",{staticClass:"q-ml-sm text-bold"},[e._v("Trong tiến trình xử lý :")]),r("div",[e.orders.data&&!e.orders.data.length?r("no-tasks",{staticClass:"q-mr-sm q-ml-sm"}):r("tasks-todo",{staticClass:"q-mr-sm",attrs:{tasksTodo:e.dataListOrderOnRq}})],1),r("q-dialog",{attrs:{"transition-show":"flip-down","transition-hide":"flip-up"},model:{value:e.history,callback:function(t){e.history=t},expression:"history"}},[r("tasks-todo",{staticClass:"q-mr-sm",attrs:{tasksTodo:e.successOrder}})],1),r("q-dialog",{model:{value:e.showAddTask,callback:function(t){e.showAddTask=t},expression:"showAddTask"}},[r("add-task",{attrs:{order:e.order},on:{close:function(t){e.showAddTask=!1}}})],1),r("q-page-scroller",{attrs:{position:"bottom-right","scroll-offset":10,offset:[18,18]}},[r("q-btn",{attrs:{fab:"",icon:"keyboard_arrow_up",color:"primary"}})],1)],1)},s=[],n=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("7f7f"),r("a34a")),o=r.n(n),i=(r("96cf"),r("c973")),c=r.n(i),l=(r("f751"),r("9523")),d=r.n(l),u=r("2f62"),f=r("bc3a"),p=r.n(f);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={data:function(){return{history:!1,showAddTask:!1,order:{},title:"",proposalForms:[],ordersData:null,dataOrder:null,selected:null,expandedRowKeys:[],selectedRowKeys:[],dSBieuMauSuDung:null,dataListOrder:null,dataListOrderOnRq:null,successOrder:null,customize:[{label:"Danh sách đề xuất",header:"root",children:[]}],listParentNS:[],listParentVT:[]}},computed:b(b(b({},Object(u["c"])("orders",["orders"])),Object(u["c"])("base",["userInfo"])),{},{bieuMaus:function(){return this.dSBieuMauSuDung?this.dSBieuMauSuDung.map((function(e){return e.parentId?e:b(b({},e),{},{parentId:0})})):[]}}),methods:b(b({},Object(u["b"])("orders",["getAllOrders","resetOrder"])),{},{activeHistory:function(){console.log("dasdasd"),this.history=!0},selected2:function(e){console.log("",e)},themDeXuat:function(e){console.log(e),"Nhân sự"!=e.node.label&&"Vật tư"!=e.node.label&&(this.order=Object.assign({},{accountId:this.userInfo.id,proposalFormId:e.node.id,departmentId:this.userInfo.departmentId,title:e.node.label,factoryId:this.userInfo.factoryId,slug:e.node.slug}),console.log(this.order),this.showAddTask=!0)},goBack:function(){this.$router.go(-2)},loadData:function(){var e=this;return c()(o.a.mark((function t(){var r,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getAllOrders(e.userInfo.id);case 2:return e.dataOrder=t.sent,t.next=5,p.a.get("/api/v2/accountForm?accountId="+e.userInfo.id);case 5:return r=t.sent,a=r.data,e.dSBieuMauSuDung=a.data,console.log("this.dSBieuMauSuDung"),console.log(e.dSBieuMauSuDung),console.log("orderdsdsd",e.orders),t.next=13,e.dataOrder.data.filter((function(e){return"Đã được duyệt"==e.status}));case 13:return e.successOrder=t.sent,t.next=16,e.dataOrder.data.filter((function(e){return"Mới"==e.status}));case 16:e.dataListOrderOnRq=t.sent,console.log("this.dataOrder",e.dataOrder),console.log("this.dataListOrder",e.successOrder),console.log("this.dataListOrderOnRq",e.dataListOrderOnRq);case 20:case"end":return t.stop()}}),t)})))()}}),components:{"add-task":r("10fb").default,"tasks-todo":r("f622").default,"no-tasks":r("1105").default},created:function(){var e=this;return c()(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadData();case 2:return console.log("biểu mẫu",e.bieuMaus),t.next=5,e.bieuMaus.forEach((function(t){18==t.parentId&&e.listParentNS.push({label:t.name,header:"generic",slug:t.slug,id:t.id}),1024==t.parentId&&e.listParentVT.push({label:t.name,header:"generic",slug:t.slug,id:t.id})}));case 5:return t.next=7,e.bieuMaus.forEach((function(t){0==t.parentId&&18==t.id&&e.customize[0].children.push({label:t.name,icon:"book",header:"generic",children:e.listParentNS}),0==t.parentId&&1024==t.id&&e.customize[0].children.push({label:t.name,icon:"book",header:"generic",children:e.listParentVT})}));case 7:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.$root.$on("showAddOrder",(function(){e.showAddTask=!0})),this.proposalForms=this.dSBieuMauSuDung}},g=h,O=(r("d84f"),r("2877")),k=r("9989"),v=r("9c40"),y=r("f09f"),q=r("7f41"),w=r("0016"),x=r("9564"),j=r("24e8"),_=r("50964"),S=r("2eeb"),D=r("eebe"),P=r.n(D),C=Object(O["a"])(g,a,s,!1,null,"3d7f4366",null);t["default"]=C.exports;P()(C,"components",{QPage:k["a"],QBtn:v["a"],QCard:y["a"],QTree:q["a"],QIcon:w["a"],QToggle:x["a"],QDialog:j["a"],QPageScroller:_["a"]}),P()(C,"directives",{GoBack:S["a"]})},"10fb":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticStyle:{"border-radius":"8px"}},[r("q-card-section",{staticClass:"bg-primary text-white",staticStyle:{"font-size":"16px"}},[e._v("\n    "+e._s(e.order.title)+"\n  ")]),r("form",{on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[r("q-card-section",[r("modal-task-name",{ref:"modalTaskName",attrs:{name:e.order.title},on:{"update:name":function(t){return e.$set(e.order,"title",t)}}})],1),r("modal-buttons",{staticStyle:{"margin-top":"-40px"}})],1)],1)},s=[],n=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("a34a")),o=r.n(n),i=(r("96cf"),r("c973")),c=r.n(i),l=(r("7f7f"),r("9523")),d=r.n(l),u=r("2f62");function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={props:["order"],data:function(){return{taskToSubmit:{name:"",dueDate:"",dueTime:"",completed:!1}}},computed:p({},Object(u["c"])("base",["userInfo"])),methods:p(p({},Object(u["b"])("orders",["addOrder","getAllOrders"])),{},{submitForm:function(){this.$refs.modalTaskName.$refs.name.validate(),this.$refs.modalTaskName.$refs.name.hasError||this.submitTask()},submitTask:function(){var e=this;return c()(o.a.mark((function t(){var r,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("this.order",e.order),t.next=3,e.addOrder(e.order);case 3:r=t.sent,console.log("data",r),a=e.order.slug,console.log("slug",a),console.log("data",r.data.data.id),e.$router.push({name:a,query:{id:r.data.data.id,status:"Mới"}}),e.getAllOrders(e.userInfo.id),e.$emit("close");case 11:case"end":return t.stop()}}),t)})))()}}),components:{"modal-header":r("a07c").default,"modal-task-name":r("6169").default,"modal-buttons":r("cdf1").default}},b=m,h=r("2877"),g=r("f09f"),O=r("a370"),k=r("eebe"),v=r.n(k),y=Object(h["a"])(b,a,s,!1,null,null,null);t["default"]=y.exports;v()(y,"components",{QCard:g["a"],QCardSection:O["a"]})},1105:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-banner",{staticClass:"bg-grey-3",scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"check",color:"primary"}})]},proxy:!0}])},[e._v("\n  Chưa có danh sách phiếu được tạo!\n")])},s=[],n={},o=n,i=r("2877"),c=r("54e1"),l=r("0016"),d=r("eebe"),u=r.n(d),f=Object(i["a"])(o,a,s,!1,null,null,null);t["default"]=f.exports;u()(f,"components",{QBanner:c["a"],QIcon:l["a"]})},5960:function(e,t,r){},6169:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row q-mb-sm"},[r("q-input",{ref:"name",staticClass:"col",attrs:{outlined:"",value:e.name,rules:[function(e){return!!e||"Field is required"}],autofocus:"",label:"Mô tả"},on:{input:function(t){return e.$emit("update:name",t)}},scopedSlots:e._u([{key:"append",fn:function(){return[e.name?r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(t){return e.$emit("update:name","")}}}):e._e()]},proxy:!0}])})],1)},s=[],n={props:["name"]},o=n,i=r("2877"),c=r("27f9"),l=r("0016"),d=r("eebe"),u=r.n(d),f=Object(i["a"])(o,a,s,!1,null,null,null);t["default"]=f.exports;u()(f,"components",{QInput:c["a"],QIcon:l["a"]})},6358:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],class:e.task.completed?"bg-green-1":"bg-orange-1",attrs:{clickable:""},on:{click:function(t){return e.goDetail(e.task.ProposalForm.slug)}}},[r("q-item-section",{attrs:{side:"",top:""}},[r("q-checkbox",{staticClass:"no-pointer-events",model:{value:e.task.completed,callback:function(t){e.$set(e.task,"completed",t)},expression:"task.completed"}})],1),r("q-item-section",[r("q-item-label",{staticClass:"text-subtitle2"},[e._v("\n        "+e._s(e.task.title)+" "+e._s(e.task.number)+"/2021/TH\n      ")]),r("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v("["+e._s(e.task.Account.account)+"]\n        "+e._s(e.task.Account.lastName))]),r("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v(e._s(e.task.Department.name))]),r("q-item-label",{attrs:{caption:"",lines:"3"}},[r("q-badge",{attrs:{color:"teal",label:e.task.status}}),1==e.task.priorityLevel?r("q-badge",{staticClass:"q-ml-sm",attrs:{color:"red",label:"Ưu tiên"}}):e._e(),r("q-badge",{staticClass:"q-ml-sm",attrs:{color:"red",label:1024==e.task.ProposalForm.parentId?"Phòng vật tư":"Phòng nhân sự"}}),r("q-badge",{staticClass:"q-ml-sm",attrs:{color:"teal",label:1==e.task.activeSeen?" đã xem":"chưa xem"}})],1)],1),r("q-item-section",{attrs:{side:"",top:""}},[r("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.moment(e.task.createdAt).format("L")))])],1),r("q-item-section",{attrs:{side:""}},[r("div",{staticClass:"row"},["Đã được duyệt"!=e.task.status?r("q-btn",{attrs:{flat:"",round:"",dense:"",color:"red",icon:"delete"},on:{click:function(t){return t.stopPropagation(),e.promptToDelete(e.task)}}}):e._e()],1)])],1)],1)},s=[],n=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("456d"),r("9523")),o=r.n(n),i=(r("6b54"),r("06db"),r("a481"),r("2f62"));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={props:["task","id","completed","request"],data:function(){return{showEditTask:!1,status:this.task.status.replace(/\s/g,"")}},created:function(){console.log("aa",this.task),console.log("status",this.task.status.replace(/\s/g,"")),this.CutStringDate(this.task.OrderMeta[0].dateStart.toString())},methods:l(l(l(l({CutStringDate:function(e){var t=" ";return null!=e?e.slice(0,10):t},CutStringTime:function(e){var t=" ";return null!=e?e.slice(11,19):t}},Object(i["b"])("orderMetas",["deleteOrderMetaDetail"])),Object(i["b"])("orders",["deleteOrder"])),Object(i["b"])("requests",["deleteRequest"])),{},{promptToDelete:function(e){var t=this;console.log("id",e),this.$q.dialog({title:"Xác nhận",message:"Bạn thực sự muốn xóa?",ok:{push:!0},cancel:{color:"negative"},persistent:!0}).onOk((function(){if(console.log("id.Requests.length",e.Requests.length),e.Requests.length>0){t.deleteOrder(e.id),console.log("xóa order - ordermeta - xóa request"),t.deleteOrderMetaDetail(e.id);for(var r=0;r<e.Requests.length;r++)t.deleteRequest(e.Requests[r].orderId)}else t.deleteOrder(e.id),console.log("xóa order - ordermeta"),t.deleteOrderMetaDetail(e.id)}))},goDetail:function(e){console.log("this.task",this.task.id),this.$router.push({name:e,query:{id:this.task.id}})}})},u=d,f=r("2877"),p=r("66e5"),m=r("4074"),b=r("8f8e"),h=r("0170"),g=r("58a8"),O=r("9c40"),k=r("714f"),v=r("eebe"),y=r.n(v),q=Object(f["a"])(u,a,s,!1,null,null,null);t["default"]=q.exports;y()(q,"components",{QItem:p["a"],QItemSection:m["a"],QCheckbox:b["a"],QItemLabel:h["a"],QBadge:g["a"],QBtn:O["a"]}),y()(q,"directives",{Ripple:k["a"]})},d84f:function(e,t,r){"use strict";var a=r("5960"),s=r.n(a);s.a},f622:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"q-ml-sm"},[r("list-header",{attrs:{bgcolor:"bg-orange-4"}},[e._v("Phiếu yêu cầu")]),r("q-list",{attrs:{separator:"",bordered:""}},e._l(e.tasksTodo,(function(t,a){return r("task",{key:a,attrs:{task:t,request:e.request,id:a,completed:!1}})})),1)],1)},s=[],n={props:["tasksTodo","request"],created:function(){console.log("tasksTodo",this.tasksTodo)},components:{task:r("6358").default,"list-header":r("a36f").default}},o=n,i=r("2877"),c=r("1c1c"),l=r("eebe"),d=r.n(l),u=Object(i["a"])(o,a,s,!1,null,null,null);t["default"]=u.exports;d()(u,"components",{QList:c["a"]})}}]);