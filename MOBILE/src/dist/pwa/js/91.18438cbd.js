(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[91],{bb7d:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"q-pa-sm"},[s("div",{staticClass:"row justify-center"},[s("div",{staticClass:"col-8"},[s("p",{staticClass:"prodTextTitle"},[t._v("\n                BIÊN BẢN KIỂM TRA LÒ SẤY\n            ")])]),s("div",{staticClass:"col-4"},[s("q-btn",{attrs:{color:"primary",glossy:"",label:"Hoàn thành"},on:{click:t.pushBB}})],1)]),s("div",{staticClass:"row justify-center"},[s("div",{staticClass:"col-12 col-sm-6"},[s("q-separator"),s("br")],1)]),s("div",{staticClass:"row justify-center"},t._l(t.data,(function(e,a){return s("div",{key:e.id,staticClass:"col-12 col-sm-6 col-md-4 col-lg-3 q-ma-xs"},[s("q-card",[s("q-card-section",[s("strong",{staticStyle:{"font-family":"'Time New Roman'"}},[t._v(" "+t._s(a+1)+" ."+t._s(e.checkName))])]),s("q-separator"),s("q-card-section",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-8"},[s("p",{staticClass:"prodTextNormal"},[t._v("\n                              "+t._s(e.require)+"\n                          ")])]),s("div",{staticClass:"col-4"},[s("q-checkbox",{attrs:{label:"ĐẠT"},on:{input:t.changeStatus},model:{value:e.status,callback:function(s){t.$set(e,"status",s)},expression:"item.status"}})],1)]),s("div",{staticClass:"row"})])],1)],1)})),0),s("div",{staticClass:"row justify-center q-mt-sm"},[s("div",{staticClass:"col-12 col-sm-6"},[s("p",{staticStyle:{"font-family":"'Time New Roman'","font-style":"italic"}},[t._v("Ghi chú : Lò sấy chỉ được phép hoạt động khi đáp ứng tất cả các yêu cầu trên đây.")]),s("q-separator"),s("div",{staticClass:"prodTextTitle q-mt-sm"},[s("strong",[t._v("Kết luận : ")]),"NG"===t.resultCode?s("strong",{staticStyle:{color:"red"}},[t._v(t._s(t.resultMessage))]):s("strong",{staticStyle:{color:"green"}},[t._v(t._s(t.resultMessage))])])],1)])])},c=[],n=s("a34a"),i=s.n(n),r=(s("96cf"),s("c973")),o=s.n(r),l=s("e669"),h=s("f79b"),u={data:function(){return{totalCheck:0,data:[{checkName:"Hệ thống quạt lò",require:"Tất cả các động cơ phải hoạt động tốt",status:!1,id:1},{checkName:"Hệ thống gia nhiệt",require:"Hoạt động tốt",status:!1,id:2},{checkName:"Hệ thống điều tiết ẩm",require:"Hoạt động tốt",status:!1,id:3},{checkName:"Van hơi",require:"Kín, không bị rò rỉ",status:!1,id:4},{checkName:"Van nước hồi",require:"Kín, không bị  rò rỉ",status:!1,id:5},{checkName:"Trần lò",require:"Kín, không thủng",status:!1,id:6},{checkName:"Cửa lò",require:"Kín, không hở",status:!1,id:7},{checkName:"Giấy Xenlulo",require:"Hoạt động tốt",status:!1,id:8},{checkName:"Cửa ven",require:"Hoạt động tốt",status:!1,id:9},{checkName:"Đinh, dây đo độ ẩm",require:"Hoạt động tốt",status:!1,id:10},{checkName:"Thiết bị điều khiển sấy",require:"Hoạt động tốt",status:!1,id:11},{checkName:"Vệ sinh lò sấy",require:"Sạch sẽ , không có các vật thể lạ trong lò",status:!1,id:12},{checkName:"Không bị rò rỉ nước",require:"Giàn nhiệt kín không bị rò rỉ nước",status:!1,id:13}],resultMessage:"Mẻ sấy chưa đạt tiêu chuẩn để hoạt động",resultCode:"NG",kilnBatchId:null}},created:function(){this.kilnBatchId=this.$route.params.kinlbatchid;var t=localStorage.getItem("bbktls"+this.kilnBatchId);if(t){var e=JSON.parse(t);this.data=e.data,this.totalCheck=e.totalCheck,this.resultMessage=e.resultMessage,this.resultCode=e.resultCode}},methods:{pushBB:function(){var t=this;return o()(i.a.mark((function e(){var s,a,c,n,r,o,u;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s={type:h["a"].BB_KIEM_TRA_LO_SAY,data:t.data,linkId:t.kilnBatchId,linkType:"kilnBatch",resultCode:t.resultCode,resultMessage:t.resultMessage,totalCheck:t.totalCheck},!navigator.onLine){e.next=9;break}return t.$q.loading.show({QSpinnerFacebook:l["a"]}),e.next=5,t.$store.dispatch("production/ACTION_CREATE_BB_MC",s);case 5:a=e.sent,!0===a.meta.success?(t.$q.notify({message:"Tạo biên bản thành công !",color:"green"}),t.totalCheck>=13&&(c=t.$store.getters["base/myFactoryInfor"].id,n=c+"-LOSAY",r="Đã có biên bản kiểm tra lò sấy",o=t.resultMessage,u="/",t.$sendFcm(r,o,u,n,{}).then((function(t){console.log("send fcm success",t)})).catch((function(t){console.log("send Error: "+t)}))),t.$q.loading.hide(),localStorage.setItem("bbktls"+t.kilnBatchId,""),t.$router.go(-1)):t.$q.notify({message:a.meta.messages.message,color:"red"}),e.next=10;break;case 9:t.$q.notify({message:"Không có kết nối internet",color:"red"});case 10:case"end":return e.stop()}}),e)})))()},changeStatus:function(t){t?this.totalCheck++:this.totalCheck--,this.saveDataToLocal()},saveDataToLocal:function(){var t={totalCheck:this.totalCheck,resultCode:this.resultCode,resultMessage:this.resultMessage,kinlbatchid:this.kilnBatchId,data:this.data};localStorage.setItem("bbktls"+this.kilnBatchId,JSON.stringify(t))}},watch:{totalCheck:function(t){t>=13?(this.$q.notify({message:"Mẻ sấy đã đạt tiêu chuẩn , hay nhấn hoàn thành ",color:"green",position:"center"}),this.resultCode="OK",this.resultMessage="Mẻ sấy đã đạt tiêu chuẩn để hoạt động"):(this.resultCode="NG",this.resultMessage="Mẻ sấy chưa đạt tiêu chuẩn để hoạt động")}}},d=u,g=s("2877"),k=s("9989"),m=s("9c40"),C=s("eb85"),f=s("f09f"),p=s("a370"),b=s("8f8e"),y=s("eebe"),v=s.n(y),q=Object(g["a"])(d,a,c,!1,null,null,null);e["default"]=q.exports;v()(q,"components",{QPage:k["a"],QBtn:m["a"],QSeparator:C["a"],QCard:f["a"],QCardSection:p["a"],QCheckbox:b["a"]})}}]);