(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{"7a56c":function(t,e,a){"use strict";var s=a("8a54"),i=a.n(s);i.a},"8a54":function(t,e,a){},f15b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-pa-md"},[a("app-bar",[t._v("Xác nhận kết quả cho pallet số "+t._s(this.$store.state.production.palletSelected.code))]),a("div",{staticClass:"row q-mt-md q-pa-md"},[a("div",{staticClass:"col-12 col-md-6"},[a("info-factoryfsc"),a("div",{staticClass:"row q-mb-md",staticStyle:{"margin-left":"-22px","margin-right":"-22px"}},[a("div",{staticClass:"col-12"},[a("table-coc")],1)]),a("div",{staticClass:"row",staticStyle:{"margin-left":"-22px","margin-right":"-22px"}},[a("div",{staticClass:"col-12"},[a("q-card",[a("q-card-section",[a("p",{staticClass:"prodTextTitle"},[t._v(t._s(this.$store.state.production.palletSelected.item[0].name))]),a("div",{staticClass:"prodTextNormal"},[t._v("\n                              QC: "+t._s(this.$store.state.production.palletSelected.item[0].height+" "+this.$store.state.production.palletSelected.item[0].width+" "+this.$store.state.production.palletSelected.item[0].length)+" x "+t._s(this.$store.state.production.palletSelected.inventory)+"\n                               "),this.$store.state.production.palletSelected.item[0].unit.name?a("span",[t._v("("+t._s(this.$store.state.production.palletSelected.item[0].unit.name)+")")]):t._e()]),a("q-select",{staticStyle:{"font-family":"'Time New Roman'","font-size":"16px"},attrs:{readonly:!t.allowSelectDestination,behavior:"dialog",options:t.destinations,label:"Xuất đến :"},model:{value:t.destinationSelect,callback:function(e){t.destinationSelect=e},expression:"destinationSelect"}})],1),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 q-pa-md"},[a("q-input",{attrs:{outlined:"",label:"SL đạt"},model:{value:t.passQty,callback:function(e){t.passQty=e},expression:"passQty"}})],1),a("div",{staticClass:"col-6 q-pa-md"},[a("q-input",{attrs:{outlined:"",readonly:"",label:"SL Lỗi"},model:{value:t.failQty,callback:function(e){t.failQty=e},expression:"failQty"}})],1)]),a("div",{staticClass:"row"},[a("q-btn",{staticClass:"glossy full-width",attrs:{color:"secondary",label:"Xác nhận"},on:{click:t.confirm}})],1)])],1)],1)])],1)]),a("q-inner-loading",{attrs:{showing:t.show}},[a("q-spinner-gears",{attrs:{size:"150px",color:"primary"}})],1)],1)},i=[],n=a("a34a"),o=a.n(n),l=(a("20d6"),a("96cf"),a("c973")),c=a.n(l),r=(a("6b54"),a("06db"),a("7f7f"),a("4778")),d=a("427f"),p=a("889c"),u=a("dd38"),h=(a("f79b"),{components:{"app-bar":u["a"],"info-factoryfsc":r["a"],"card-itempallet":d["a"],"table-coc":p["a"]},data:function(){return{show:!1,passQty:"",failQty:"0",destinations:[],destinationSelect:null,allowSelectDestination:!1}},methods:{confirm:function(){var t=this;this.show=!0;var e=this.$store.state.production.palletSelected.inventory;if(null!==this.destinationSelect&&parseFloat(this.passQty)>0&&parseFloat(this.passQty)<=parseFloat(e)){var a={data:{sourceId:this.$store.state.production.sourceSelected.id,destinationId:this.destinationSelect.value,notPass:this.failQty,pass:this.passQty,token:this.$store.state.production.userInfo.token},palletCode:this.$store.state.production.palletSelected.code};this.$store.dispatch("production/ACTION_STEP_PALLET",a).then((function(e){if(!0===e.meta.success){t.$q.notify({message:"Xác nhận thành công !",color:"green"});var s=null===t.destinationSelect?t.$store.state.production.palletSelected.destinationDefaultId[0].name:t.destinationSelect.label,i=t.destinationSelect.value.toString()+"-RECIVED-PALLET",n="Đã nhận được pallet số "+a.palletCode,o="Nhận được pallet từ công đoạn "+t.$store.state.production.sourceSelected.name+" chuyển đến công đoạn "+s,l="/#/production-dashboard?code="+a.palletCode;t.$sendFcm(n,o,l,i,{palletCode:a.palletCode}).then((function(t){console.log(t)})),t.$router.go(-1)}}))}else this.$q.notify({message:"Thông tin chưa đủ !",color:"red"}),this.show=!1},initDestination:function(){var t=this;return c()(o.a.mark((function e(){var a;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={itemId:t.$store.state.production.palletSelected.item[0].id,token:t.$store.state.production.userInfo.token},e.next=3,t.$store.dispatch("production/ACTION_GET_DESTINATION_BY_ITEM",a).then((function(e){if(e.data.length>0){var a=e.data.findIndex((function(e){return e.id===t.$store.state.production.sourceSelected.id})),s={label:e.data[a+1].name,value:e.data[a+1].id};t.destinations.push(s),t.destinationSelect=s}t.$store.getters["base/myDestinations"].length>0&&t.$store.getters["base/myDestinations"].forEach((function(e){if(-1===t.destinations.findIndex((function(t){return t.value===e.id}))){var a={label:e.name,value:e.id};t.destinations.push(a)}})),1===t.destinations.length&&(t.allowSelectDestination=!0,t.destinationSelect=t.destinations[0],t.$q.notify({message:"Hãy chú ý nơi xuất pallet !",color:"orange"})),t.allowSelectDestination=!0,t.passQty=t.$store.state.production.palletSelected.inventory.toString(),t.failQty="0"}));case 3:case"end":return e.stop()}}),e)})))()}},watch:{passQty:function(t){var e=parseFloat(this.$store.state.production.palletSelected.inventory);""===t.trim()?this.failQty="0":t>e?(this.$q.notify({message:"Vượt quá số lượng !",color:"red"}),this.failQty="0"):this.failQty=e-parseFloat(t)}},created:function(){this.initDestination()},beforeMount:function(){console.log(this.$store.state.production.palletSelected),""!==this.$store.state.production.palletSelected.code&&void 0!==this.$store.state.production.palletSelected.code&&null!==this.$store.state.production.palletSelected.code||(this.$q.notify({color:"red",message:"Đã xảy ra lỗi !",timeout:3e3}),this.$router.push("/production-select-source"))}}),f=h,m=(a("7a56c"),a("2877")),S=a("9989"),y=a("f09f"),v=a("a370"),g=a("ddd8"),$=a("eb85"),b=a("27f9"),Q=a("9c40"),w=a("74f7"),C=a("cf57"),q=a("eebe"),x=a.n(q),_=Object(m["a"])(f,s,i,!1,null,null,null);e["default"]=_.exports;x()(_,"components",{QPage:S["a"],QCard:y["a"],QCardSection:v["a"],QSelect:g["a"],QSeparator:$["a"],QInput:b["a"],QBtn:Q["a"],QInnerLoading:w["a"],QSpinnerGears:C["a"]})}}]);