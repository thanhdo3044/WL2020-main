(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[120],{a1fe:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-pa-sm"},[n("div",{staticClass:"q-gutter-md"},[n("q-input",{attrs:{outlined:"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1),n("q-dialog",{attrs:{maximized:!1},model:{value:e.card,callback:function(t){e.card=t},expression:"card"}},[e.po?n("q-card",{staticClass:"my-card"},[n("q-card-section",[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",flat:"",icon:"keyboard_arrow_left",label:"Trở lại"}}),n("q-input",{attrs:{readonly:!0,type:"text",label:"Sản phẩm/Chi tiết"},model:{value:e.po.itemName,callback:function(t){e.$set(e.po,"itemName",t)},expression:"po.itemName"}}),n("div",{staticClass:"row"},[n("div",{staticClass:"col-4",attrs:{align:"center"}},[n("q-input",{attrs:{readonly:!0,type:"text",label:"Dầy"},model:{value:e.po.itemHeight,callback:function(t){e.$set(e.po,"itemHeight",t)},expression:"po.itemHeight"}})],1),n("div",{staticClass:"col-4",attrs:{align:"center"}},[n("q-input",{attrs:{readonly:!0,type:"text",label:"Rộng"},model:{value:e.po.itemWidth,callback:function(t){e.$set(e.po,"itemWidth",t)},expression:"po.itemWidth"}})],1),n("div",{staticClass:"col-4",attrs:{align:"center"}},[n("q-input",{attrs:{readonly:!0,type:"text",label:"Dài"},model:{value:e.po.itemLenght,callback:function(t){e.$set(e.po,"itemLenght",t)},expression:"po.itemLenght"}})],1)]),n("q-input",{attrs:{value:e._f("soDep")(e.po.keHoach),readonly:!0,type:"number",label:"Số lượng theo Kế hoạch"}}),["101280","100264","100274"].includes(e.po.stepId)?e._e():n("q-list",{staticClass:"bg-green-3"},[n("q-item-label",{attrs:{header:""}},[e._v("Phôi có thể xuất (Đồng bộ: "+e._s(e.maxCoTheGhiNhan)+")")]),e._l(e.findTonTaiTosByItem2(e.po.nguyenLieu,e.po.itemId),(function(t){return n("div",{key:t.itemId},[n("q-separator"),n("q-item",[n("q-item-section",[n("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v("#"+e._s(t.itemName)+" x "+e._s(t.heSo)+":\n                  "),n("q-badge",{attrs:{label:t.ton}})],1)],1)],1)],1)}))],2),n("q-input",{attrs:{readonly:!1,type:"number",label:"Số lượng lỗi"},model:{value:e.defectQty,callback:function(t){e.defectQty=e._n(t)},expression:"defectQty"}}),n("q-input",{attrs:{value:e._f("soDep")(e.po.daThucHien),readonly:!0,type:"text",label:"Đã sản xuất (Click)"},on:{click:function(t){e.sanLuongsDialog=!0}}}),n("q-input",{attrs:{value:e._f("soDep")(e.po.error),readonly:!0,type:"text","label-color":"negative",label:"Lỗi"}}),n("q-input",{attrs:{value:e._f("soDep")(e.po.loiCongDon),readonly:!0,type:"number","label-color":"warning",label:"Lỗi công đoạn"}}),n("q-input",{attrs:{readonly:!0,type:"text",label:"Công đoạn nhận"},model:{value:e.po.stepNextName,callback:function(t){e.$set(e.po,"stepNextName",t)},expression:"po.stepNextName"}}),n("q-input",{attrs:{value:e.po.conTon,readonly:!0,"label-color":"accent",type:"number",label:"Số tồn có thể xuất"}}),n("q-input",{attrs:{value:e._f("soDep")(e.po.conThucHien),readonly:!0,type:"number","label-color":"primary",color:"primary",label:"Số lượng còn phải sản xuất"}}),n("q-input",{attrs:{type:"number",label:"Số lượng ghi nhận"},model:{value:e.confirmQty,callback:function(t){e.confirmQty=e._n(t)},expression:"confirmQty"}})],1),n("q-separator"),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{color:"primary",flat:"",label:"Ghi nhận",disable:e.isValidate},on:{click:function(t){e.secondDialog=!0}}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đóng"}})],1)],1):e._e()],1),n("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.nhanPhoisDialog,callback:function(t){e.nhanPhoisDialog=t},expression:"nhanPhoisDialog"}},[n("q-card",{staticStyle:{width:"300px"}},[n("q-card-section",{},[n("div",{staticClass:"text-h6"},[e._v("Phôi chờ nhận")]),n("div",{staticClass:"q-gutter-md"},[n("q-input",{attrs:{outlined:"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1)]),e.phoiChoNhanVes.length+e.sanLuongs(null).length>0?n("q-card-section",{staticClass:"q-pt-none"},[e._l(e.phoiChoNhanVes,(function(t){return n("q-card",{key:t.id},[n("q-card-section",[n("div",{staticClass:"text-subtitle2"},[e._v("\n              "+e._s(t.itemName)+"\n            ")])]),n("q-card-section",{staticClass:"q-pt-none"},[n("q-list",[n("q-item",[n("q-item-section",[n("q-item-label",[e._v("Số lượng: "+e._s(t.soLuong))]),n("q-item-label",[e._v("Nguồn phôi: (Kế hoạch ghép)")]),n("q-item-label",{attrs:{caption:""}},[e._v("Ngày giao: (Nhập kho)")]),n("q-item-label",{attrs:{caption:""}},[e._v("Lệnh sản xuất: "+e._s(t.number))])],1)],1)],1)],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{dense:"",icon:"cloud_download","no-caps":"",color:"primary",label:"Nhận"},on:{click:function(n){return e.capPhoiPoCode(t.code,t.nhanVe)}}})],1)],1)})),e._l(e.sanLuongs(e.text),(function(t){return n("div",{key:t.id},[n("q-card",{staticClass:"my-card"},[n("q-card-section",[n("div",{staticClass:"text-subtitle2"},[e._v("\n                "+e._s(t.Item.name)+"\n                "+e._s([t.Item.height,t.Item.width,t.Item.length].join("*"))+"\n              ")])]),n("q-list",[n("q-item",[n("q-item-section",[n("q-item-label",[e._v("Số lượng: "+e._s(t.quantity))]),n("q-item-label",[e._v("Người giao:\n                    "+e._s(e._f("FullName")(e.getAccountById(t.accountId))))]),n("q-item-label",{attrs:{caption:""}},[e._v("Ngày giao: "+e._s(e._f("ngay")(t.createdAt)))]),n("q-item-label",{attrs:{caption:""}},[e._v("Lệnh sản xuất: "+e._s(t.number))]),n("q-item-label",{attrs:{caption:""}},[e._v("No: "+e._s(t.packageId))])],1)],1)],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{dense:"",icon:"cloud_download","no-caps":"",color:"primary",label:"Nhận"},on:{click:function(n){return e.nhanPhoi(t.packageId)}}})],1)],1),n("q-separator")],1)}))],2):n("q-card-section",{staticClass:"q-pt-none"},[n("p",[e._v("Không có phôi chờ nhận về")])]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đóng",color:"primary"}})],1)],1)],1),n("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.sanLuongsDialog,callback:function(t){e.sanLuongsDialog=t},expression:"sanLuongsDialog"}},[n("q-card",{staticStyle:{width:"300px"}},[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("Lịch sử ghi nhận")])]),n("q-card-section",{staticClass:"q-pt-none"},e._l(e.po.VItemInPackages,(function(t){return n("q-card",{key:t.id},[n("q-card-section",[n("div",{staticClass:"text-subtitle2"},[e._v("\n              "+e._s(e.po.Item.name)+"\n            ")])]),n("q-card-section",{staticClass:"q-pt-none"},[n("q-list",[n("q-item",[n("q-item-section",[n("q-item-label",[e._v("Số lượng: "+e._s(t.quantity))]),n("q-item-label",[e._v("Người giao:\n                    "+e._s(e._f("FullName")(e.getAccountById(t.accountId))))]),n("q-item-label",{attrs:{caption:""}},[e._v("Ngày giao: "+e._s(e._f("ngay")(t.createdAt)))]),n("q-item-label",{attrs:{caption:""}},[e._v("Lệnh sản xuất: "+e._s(t.number))])],1)],1)],1)],1)],1)})),1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đóng",color:"primary"}})],1)],1)],1),n("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.secondDialog,callback:function(t){e.secondDialog=t},expression:"secondDialog"}},[n("q-card",{staticStyle:{width:"300px"}},[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("Xác nhận")])]),n("q-card-section",{staticClass:"q-pt-none"},[e.confirmQty?n("p",[e._v("\n          Ghi nhận "),n("q-badge",{attrs:{color:"secondary"}},[e._v(e._s(e.confirmQty))])],1):e._e(),e.defectQty?n("span",{staticStyle:{color:"red"}},[e._v("Lỗi : "+e._s(e.defectQty))]):e._e()]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đồng ý",color:"primary"},on:{click:e.add}})],1)],1)],1),n("DialogSuccess",{attrs:{closeDialog2:e.closeDialog2,palletCode:e.packageString,show:e.showSuccess,closeDialog:e.closeSuccessDialog}}),n("a",{staticClass:"q-mt-sm text-primary float-right text-subtitle2",attrs:{href:"#"},on:{click:function(t){e.nhanPhoisDialog=!0}}},[e._v("Nhận phôi ("+e._s(e.phoiChoNhanVes.length)+")("+e._s(e.sanLuongs(null).length)+")")]),n("br"),n("br"),n("q-list",{attrs:{separator:"",bordered:""}},e._l(e.posG(e.searchQuery,e.gop),(function(t){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,attrs:{clickable:""},on:{click:function(n){return e.showConfirmDialog(t)}}},[n("q-item-section",[n("q-item-label",{staticClass:"text-subtitle2"},[e._v("\n          "+e._s(t.Item.name)+" ("+e._s(t.Item.length)+"*"+e._s(t.Item.width)+"*"+e._s(t.Item.height)+")\n        ")]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[n("q-badge",{attrs:{color:"teal"}},[e._v("\n            "+e._s(e.gop?"":t.number.toUpperCase())+"\n            "+e._s(e._f("marketName")(e.findMarketByCode(t.root)))+"\n          ")])],1)],1),n("q-item-section",{attrs:{side:"",top:""}},[n("q-item-label",{attrs:{caption:""}},[t.ton-t.xuatTon?n("q-badge",{attrs:{color:"accent",label:t.ton-t.xuatTon}}):e._e(),e._v("\n           \n          "),n("q-badge",{attrs:{color:"teal",label:e._f("soDep")(t.conThucHien)}})],1)],1)],1)})),1),n("div",{staticClass:"inline rounded-borders cursor-pointer",staticStyle:{"max-width":"300px"}},[n("div",{staticClass:"fit flex flex-center text-center non-selectable q-pa-md"},[e._v("\n      Công đoạn: ("+e._s(e.congdoan.name)+")\n    ")]),n("q-menu",{attrs:{"touch-position":""}},[n("q-list",{staticStyle:{"min-width":"100px"}},e._l(e.myDepartments,(function(t){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.id,attrs:{clickable:""}},[n("q-item-section",{on:{click:function(n){return e.chonCongdoan(t)}}},[e._v("\n            "+e._s(t.name)+"\n          ")])],1)})),1)],1)],1)],1)},o=[],i=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("456d"),n("c5f6"),n("7cdf"),n("6b54"),n("06db"),n("7514"),n("a481"),n("a34a")),s=n.n(i),r=(n("96cf"),n("c973")),c=n.n(r),l=n("448a"),p=n.n(l),u=(n("6762"),n("2fdb"),n("9523")),h=n.n(u),d=n("2f62"),m=n("c1df"),g=n.n(m),f=n("fa7d"),y=n("c0af");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q={components:{DialogSuccess:y["a"]},data:function(){return{text:"",phoiChoNhanVes:[],nhanPhoisDialog:!1,gop:!0,sanLuongsDialog:!1,searchQuery:"",congdoan:{name:"Không tìm thấy công đoạn"},maxCoTheGhiNhan:0,secondDialog:!1,description:g()().format("w"),ghinhan:0,arr:"",card:!1,task:null,standard:0,showSuccess:!1,packageId:"",confirmQty:"",confirmData:"",target:"",defectQty:"",receiptQty:"",historys:[],lenhsanxuat:"",maxQtyConfirm:0,packageString:"",totalDeliver:0,po:{code:"POac705671-03af-46bd-9a1c-4ff54b527987",daNhanTon:null,stepId:"100277",number:"1111",week:45,year:2020,market:null,ngayDongGoi:"2020-11-02T00:00:00.000Z",factoryId:1e5,keHoach:1,loiCongDon:0,xuatTon:0,stepName:"6.HTD - X3",stepNextId:100282,stepNextName:"8.Đóng gói - X3",order:5,itemId:118579,itemCode:"ID-0045",itemName:"SKOGSTA chopping board 35x20 acacia",itemLenght:350,itemWidth:200,itemHeight:25,UNIT_ID:1e5,target:1,ton:0,quantity:null,error:null,status:"Đang sản xuất"}}},computed:x(x(x(x(x({},Object(d["c"])("orders",["getAccountById"])),Object(d["c"])("base",["myDepartments","findItemById","findMarketByCode","userInfo","myFactoryInfor"])),Object(d["c"])("po",["posG","posByItemIdAndMarket"])),Object(d["c"])("production",["isDongBoPhoi","isThieuPhoi","tyLeThucHienByItemId","findTonTaiTosByItem2","sanLuongs","isCheckPhoiByItemId"])),{},{getMaxCapPhoi:function(){return 100},isValidate:function(){return!(this.confirmQty&&(!this.po.stepName.toLowerCase().includes("đóng gói")||this.description))&&!(this.defectQty&&(!this.po.stepName.toLowerCase().includes("đóng gói")||this.description))}}),methods:x(x(x(x({},Object(d["b"])("base",["getItemsSanXuat","getMarketsByFactory"])),Object(d["b"])("po",["lenhSanXuatThucHien"])),Object(d["b"])("production",["getDinhMucs","getTyLeTHs","getPoByCode1","getTonTaiTo","addPackage1","getAllChoNhans"])),{},{getMaxPhoiCoTheXuat:function(e){var t=this.findTonTaiTosByItem2(this.po.nguyenLieu,e).map((function(e){return e.ton/e.heSo}));return console.log(t),t.length>0?Math.min.apply(Math,p()(t)):0},isCheckPhoi:function(e){return!["100264","100274"].includes(e)},nhanPhoi:function(e){var t=this;return c()(s.a.mark((function n(){return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("production/POST_NHAN_LOT_NO",{packageId:e});case 2:return n.next=4,t.load(t.congdoan.id);case 4:0===t.phoiChoNhanVes.length&&0===t.sanLuongs.length&&(t.nhanPhoisDialog=!1);case 5:case"end":return n.stop()}}),n)})))()},capPhoiPoCode:function(e,t){var n=this;return c()(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.$store.dispatch("po/themTonKeHoach3",{code:e,quantity:t});case 2:return a.next=4,n.load(n.congdoan.id);case 4:0===n.phoiChoNhanVes.length&&0===n.sanLuongs.length&&(n.nhanPhoisDialog=!1);case 5:case"end":return a.stop()}}),a)})))()},load:function(e){var t=this;return c()(s.a.mark((function n(){return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.lenhSanXuatThucHien(e);case 2:return n.next=4,t.$store.dispatch("production/getPhoiNhapVe",{stepId:e});case 4:t.phoiChoNhanVes=n.sent,t.getMarketsByFactory(t.myFactoryInfor),t.getDinhMucs({stepId:e}),t.getAllChoNhans({stepId:e});case 8:case"end":return n.stop()}}),n)})))()},closeDialog2:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.showSuccess=!1,e.card=!1,e.defectQty="",e.confirmQty="",e.description="";case 5:case"end":return t.stop()}}),t)})))()},closeSuccessDialog:function(){var e=this;this.showSuccess=!1,this.confirmQty="",setTimeout((function(){e.$router.push("/tracking-lot-no?code="+e.packageId)}),1e3)},chonCongdoan:function(e){var t=this;return c()(s.a.mark((function n(){var a;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.congdoan=e,t.searchQuery="",a=e.id,n.next=5,t.load(a);case 5:t.$router.replace({path:t.$route.fullPath,query:{stepId:a}});case 6:case"end":return n.stop()}}),n)})))()},showConfirmDialog:function(e){var t=this;return c()(s.a.mark((function n(){var a,o;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.code,t.$router.replace({path:t.$route.fullPath,query:{stepId:t.congdoan.id,code:a}}),t.$q.loading.show({message:'Hệ thống đang kiểm tra phôi có thể xuất.<br/><span class="text-primary">Xin vui lòng chờ...</span>'}),n.next=5,t.getPoByCode1({code:a});case 5:t.po=n.sent,t.$q.loading.hide(),t.gop,t.po=x(x({},t.po),e),t.po&&(t.card=!0),o=t.findTonTaiTosByItem2(t.po.nguyenLieu,t.po.itemId).map((function(e){return e.ton/e.heSo})).filter((function(e){return e>=0})),t.maxCoTheGhiNhan=0,o.length>0&&!["101280","100264","100274"].includes(t.po.stepId)&&t.isCheckPhoiByItemId(t.po.itemId)?t.maxCoTheGhiNhan=Math.min.apply(Math,p()(o)):t.maxCoTheGhiNhan=["101280","100264","100274"].includes(t.po.stepId)||!t.isCheckPhoiByItemId(t.po.itemId)?t.po.conThucHien:0,t.maxCoTheGhiNhan=parseFloat(parseFloat(t.maxCoTheGhiNhan).toFixed(6)),100005!==t.po.UNIT_ID&&(t.maxCoTheGhiNhan=Math.floor(t.maxCoTheGhiNhan)),t.description=g()().format("w"),t.defectQty="",t.confirmQty="";case 17:case"end":return n.stop()}}),n)})))()},add:function(){var e=this;return c()(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.defectQty||0,a=e.confirmQty||0,!(parseFloat(n)+parseFloat(a)>e.maxCoTheGhiNhan+e.po.conTon)){t.next=4;break}return t.abrupt("return",e.$q.dialog({title:"Lỗi",message:"Không đủ nguyên vật liệu"}));case 4:if(!(parseFloat(n)+parseFloat(a)>parseFloat((e.po.conThucHien+e.po.conTon).toFixed(6)))){t.next=8;break}return t.abrupt("return",e.$q.dialog({title:"Lỗi",message:"Tổng khối lượng vượt quá kế hoạch!"+(e.po.conThucHien+e.po.conTon)}));case 8:if(!(parseFloat(n)>0)){t.next=11;break}return t.next=11,e.createPackage(100004,n);case 11:if(!(parseFloat(a)>0)){t.next=19;break}if(!e.gop){t.next=17;break}return t.next=15,e.ghiNhanGop(a);case 15:t.next=19;break;case 17:return t.next=19,e.createPackage(100026,a);case 19:return t.next=21,e.load(e.congdoan.id);case 21:case"end":return t.stop()}}),t)})))()},createPackage:function(e,t,n){var a=this;return c()(s.a.mark((function o(){var i,r,c,l;return s.a.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return console.log(n,t),n||(n=a.po.code),i=a.po.stepNextId,100004===e&&(r=a.$store.getters["base/mySources"].find((function(e){return e.id===parseInt(a.po.stepId)})),r&&(i=r.error)),c={sourceId:a.po.stepId,destinationId:i,itemId:a.po.itemId,quantity:t,typeId:e,description:a.description,po:n},o.next=7,a.addPackage1(c);case 7:l=o.sent,l.meta.success?(a.packageString=l.data[0].id.toString(),a.packageId=l.data[0].id,a.maxQtyConfirm=a.maxQtyConfirm-parseFloat(t),100026===e&&(a.showSuccess=!0),Object(f["o"])()):Object(f["n"])();case 9:case"end":return o.stop()}}),o)})))()},ghiNhanGop:function(e){var t=this;return c()(s.a.mark((function n(){var a,o,i,r,c,l,p,u,h,d,m,g,f,y,b,x,q,v,k,I,_,C,T,N;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e,n.next=3,t.getMaxPhoiCoTheXuat(t.po.itemId);case 3:return o=n.sent,n.next=6,t.posByItemIdAndMarket(t.po.itemId,t.po.market);case 6:i=n.sent,r=0;case 8:if(!(r<i.length)){n.next=23;break}if(c=i[r],l=c.stepId,p=c.code,u=c.VItemInPackages,h=c.keHoach,d=c.hanMucTon,m=c.soLuongUuTien,g=c.ys1a,f=c.ys1b,y=c.ys4,b=c.th,x=c.loiCongDon,q=c.ton,v=c.xuatTon,k=q-v,I=u.reduce((function(e,t){var n=t.quantity;return e+n}),0),_=h+d-g-f-y-b-m+x+v-I,C=k,t.isCheckPhoi(l)&&t.isCheckPhoiByItemId(t.po.itemId)?(console.log("Check Phoi",o),_>0&&o>0&&(T=_>o?o:_,C+=T,o-=T)):C+=_,N=a<C?a:C,!(a>0&&parseFloat(parseFloat(N).toFixed(6))>0)){n.next=20;break}return n.next=19,t.createPackage(100026,parseFloat(parseFloat(N).toFixed(6)),p);case 19:a-=N;case 20:r++,n.next=8;break;case 23:case"end":return n.stop()}}),n)})))()},autoP:function(){var e=this;return c()(s.a.mark((function t(){var n,a,o,i,r,c;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.card=!0,n=p()(e.posG("")),a=0;case 3:if(!(a<n.length)){t.next=36;break}return o=n[a],i=o.code,t.next=8,e.getPoByCode1({code:i});case 8:if(e.po=t.sent,e.gop,e.po=x(x({},e.po),o),r=e.findTonTaiTosByItem2(e.po.nguyenLieu,e.po.itemId).map((function(e){return e.ton/e.heSo})).filter((function(e){return e>=0})),e.maxCoTheGhiNhan=0,r.length>0&&!["101280","100264","100274"].includes(e.po.stepId)&&e.isCheckPhoiByItemId(e.po.itemId)?e.maxCoTheGhiNhan=Math.min.apply(Math,p()(r)):e.maxCoTheGhiNhan=["101280","100264","100274"].includes(e.po.stepId)||!e.isCheckPhoiByItemId(e.po.itemId)?e.po.conThucHien:0,e.maxCoTheGhiNhan=parseFloat(parseFloat(e.maxCoTheGhiNhan).toFixed(6)),100005!==e.po.UNIT_ID&&(e.maxCoTheGhiNhan=Math.floor(e.maxCoTheGhiNhan)),e.description=g()().format("w"),e.defectQty="",c=(e.maxCoTheGhiNhan<e.po.conThucHien?e.maxCoTheGhiNhan:e.po.conThucHien)+e.po.conTon,e.confirmQty=e.cQty,t.prev=19,!(parseFloat(c)>0)){t.next=28;break}if(!e.gop){t.next=26;break}return t.next=24,e.ghiNhanGop(parseFloat(parseFloat(c).toFixed(6)));case 24:t.next=28;break;case 26:return t.next=28,e.createPackage(100026,c);case 28:t.next=33;break;case 30:t.prev=30,t.t0=t["catch"](19),console.log(t.t0);case 33:a++,t.next=3;break;case 36:case"end":return t.stop()}}),t,null,[[19,30]])})))()}}),created:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.myDepartments.length){t.next=4;break}return e.congdoan=e.myDepartments.find((function(t){return t.id==e.$route.query.stepId}))||e.myDepartments[0],t.next=4,e.chonCongdoan(e.congdoan);case 4:case"end":return t.stop()}}),t)})))()},watch:{defectQty:function(e){parseFloat(e)+parseFloat(this.confirmQty||0)>parseFloat((this.po.conThucHien+this.po.conTon).toFixed(6))&&this.$q.dialog({title:"Lỗi",message:"Tổng khối lượng vượt quá kế hoạch!xxx"}),100005!==this.po.UNIT_ID&&e&&!Number.isInteger(e)&&this.$q.dialog({title:"Lỗi",message:"Bạn cần nhập số nguyên!"})},confirmQty:function(e){console.log(this.po),parseFloat(this.defectQty||0)+parseFloat(e)>parseFloat((this.po.conThucHien+this.po.conTon).toFixed(6))&&this.$q.dialog({title:"Lỗi",message:"Tổng khối lượng vượt quá kế hoạch!"+(this.po.conThucHien+this.po.conTon)}),parseFloat(this.defectQty||0)+parseFloat(e)>this.maxCoTheGhiNhan+this.po.conTon&&this.$q.dialog({title:"Lỗi",message:"Không đủ nguyên vật liệu"}),100005!==this.po.UNIT_ID&&e&&!Number.isInteger(e)&&this.$q.dialog({title:"Lỗi",message:"Bạn cần nhập số nguyên!"})}}},v=q,k=n("2877"),I=n("9989"),_=n("27f9"),C=n("0016"),T=n("24e8"),N=n("f09f"),w=n("a370"),D=n("9c40"),P=n("1c1c"),Q=n("0170"),S=n("eb85"),L=n("66e5"),F=n("4074"),O=n("58a8"),B=n("4b7e"),G=n("4e73"),H=n("7f67"),$=n("714f"),j=n("eebe"),M=n.n(j),V=Object(k["a"])(v,a,o,!1,null,null,null);t["default"]=V.exports;M()(V,"components",{QPage:I["a"],QInput:_["a"],QIcon:C["a"],QDialog:T["a"],QCard:N["a"],QCardSection:w["a"],QBtn:D["a"],QList:P["a"],QItemLabel:Q["a"],QSeparator:S["a"],QItem:L["a"],QItemSection:F["a"],QBadge:O["a"],QCardActions:B["a"],QMenu:G["a"]}),M()(V,"directives",{ClosePopup:H["a"],Ripple:$["a"]})}}]);