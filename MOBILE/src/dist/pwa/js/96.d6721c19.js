(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[96],{"63ab":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"q-pa-md"},[n("div",[n("app-bar",[t._v("Xử lý hàng lỗi")]),n("div",{staticClass:"row q-mt-md"},[n("div",{staticClass:"col-12"},[n("q-card",[n("q-card-section",[n("div",{staticClass:"prodTextTitle"},[t._v("\n                      Thông tin Qui cách lỗi\n                  ")])]),n("q-separator"),n("q-card-section",{staticStyle:{"font-family":"'Time'","font-size":"16px"}},[n("p",{staticStyle:{color:"orange"}},[t._v("Qui cách : "+t._s(t.infoInventory.quicach))]),n("p",[t._v("Số lượng lỗi : "+t._s(t.infoInventory.remain))]),n("p",[t._v("Nhận từ công đoạn : "+t._s(t.infoInventory.from))])])],1)],1)]),n("div",{staticClass:"row justify-center q-mt-md"},[n("div",{staticClass:"col-12 q-ma-sm"},[n("q-select",{staticStyle:{"font-family":"'Time New Roman'","font-size":"16px","text-align":"center"},attrs:{behavior:"dialog",options:t.defects,label:"Chọn loại lỗi :"},on:{input:t.selectDef},model:{value:t.defect,callback:function(e){t.defect=e},expression:"defect"}})],1)]),null!==t.defect?n("div",{staticClass:"row justify-center q-mt-md"},[n("div",{staticClass:"col-12"},[n("q-input",{attrs:{outlined:"",label:"Số lượng lỗi :"},model:{value:t.qtyDefect,callback:function(e){t.qtyDefect=t._n(e)},expression:"qtyDefect"}}),n("q-select",{staticStyle:{"font-family":"'Time New Roman'","font-size":"16px","text-align":"center"},attrs:{behavior:"dialog",options:t.solutions,label:"Chọn giải pháp :"},model:{value:t.solution,callback:function(e){t.solution=e},expression:"solution"}}),n("q-select",{staticStyle:{"font-family":"'Time New Roman'","font-size":"16px","text-align":"center"},attrs:{behavior:"dialog",options:t.destinations,label:"Chọn công đoạn xuất :"},model:{value:t.destination,callback:function(e){t.destination=e},expression:"destination"}}),n("br"),n("p",[t._v("Ghi chú :")]),n("q-input",{attrs:{filled:"",type:"textarea"},model:{value:t.note,callback:function(e){t.note=e},expression:"note"}}),n("q-btn",{staticClass:"full-width q-mt-md",attrs:{color:"primary",label:"Lưu lại"},on:{click:t.save}})],1)]):t._e(),n("q-dialog",{attrs:{persistent:""},model:{value:t.showConfirm,callback:function(e){t.showConfirm=e},expression:"showConfirm"}},[n("q-card",{staticStyle:{"min-width":"300px"}},[n("q-card-section",{staticClass:"row items-center"},[n("span",{staticClass:"q-ml-sm prodTextTitle"},[t._v("Bạn có chắc chắn không!")])]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy",color:"primary"}}),n("q-btn",{attrs:{flat:"",label:"Đồng Ý",color:"primary"},on:{click:t.submit}})],1)],1)],1)],1),n("q-inner-loading",{attrs:{showing:t.showLoading}},[n("q-spinner-gears",{attrs:{size:"150px",color:"primary"}})],1)],1)},o=[],a=n("a34a"),s=n.n(a),r=(n("96cf"),n("c973")),c=n.n(r),l=(n("6b54"),n("7f7f"),n("551c"),n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("dd38")),d={components:{"app-bar":l["a"]},data:function(){return{showLoading:!0,solutions:[],solution:null,destination:null,destinations:[],defects:[],defect:null,note:"",qtyDefect:"",showConfirm:!1,infoInventory:{}}},created:function(){this.initData()},methods:{initData:function(){var t=this,e="";Promise.all([this.$store.dispatch("production/ACTION_GET_SOLUTION_QC",e),this.$store.dispatch("production/ACTION_GET_PACKAGE_TYPE",e)]).then((function(e){t.showLoading=!1,t.$store.state.production.defects.forEach((function(e){var n={label:e.name,value:e.id};t.defects.push(n)})),t.$store.state.production.solutions.forEach((function(e){var n={label:e.name,value:e.id};t.solutions.push(n)})),t.$store.getters["base/myDestinations"].forEach((function(e){var n={label:e.name,value:e.id};t.destinations.push(n)})),t.infoInventory={quicach:t.$store.state.production.inventoryQCSelected.item.height+" "+t.$store.state.production.inventoryQCSelected.item.width+" "+t.$store.state.production.inventoryQCSelected.item.length,remain:t.$store.state.production.inventoryQCSelected.remain,from:t.$store.state.production.inventoryQCSelected.from.name}})).catch((function(e){t.$q.notify({message:e,color:"red"})}))},selectDef:function(t){},save:function(){null!==this.destination&&null!==this.defect&&null!==this.solution&&this.qtyDefect.toString().length>0&&parseFloat(this.qtyDefect)<=parseFloat(this.infoInventory.remain)?this.showConfirm=!0:this.$q.notify({message:"Thiếu thông tin , vui lòng kiểm tra lại !",color:"red"})},submit:function(){var t=this;return c()(s.a.mark((function e(){var n,i;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showConfirm=!1,t.showLoading=!0,n={sourceId:t.$store.state.production.inventoryQCSelected.id,destinationId:t.destination.value,itemId:t.$store.state.production.inventoryQCSelected.item.id,quantity:t.qtyDefect,materialsId:t.$store.state.production.inventoryQCSelected.item.id,materialsQuantity:t.qtyDefect,typeId:t.defect.value,remediesId:t.solution.value,description:t.note,itemFromId:t.$store.state.production.inventoryQCSelected.fromId},e.next=5,t.$store.dispatch("production/ACTION_CREATE_PACKAGE",n);case 5:i=e.sent,!0===i.meta.success?(t.infoInventory.remain=t.infoInventory.remain-t.qtyDefect,t.qtyDefect="",t.solution=null,t.description="",t.destination=null,t.$q.notify({message:"Thực hiện thành công !",color:"green"}),t.defect=null,0===t.infoInventory.remain&&(t.$q.notify({message:"Số lượng lỗi đã hết  !",color:"orange"}),t.$router.go(-1))):t.$q.notify({message:i.meta.messages.message,color:"red",position:"center"}),t.showLoading=!1;case 8:case"end":return e.stop()}}),e)})))()}}},u=d,f=n("2877"),m=n("9989"),p=n("f09f"),h=n("a370"),v=n("eb85"),y=n("ddd8"),g=n("27f9"),q=n("9c40"),C=n("24e8"),b=n("4b7e"),w=n("74f7"),Q=n("cf57"),S=n("7f67"),I=n("eebe"),x=n.n(I),$=Object(f["a"])(u,i,o,!1,null,null,null);e["default"]=$.exports;x()($,"components",{QPage:m["a"],QCard:p["a"],QCardSection:h["a"],QSeparator:v["a"],QSelect:y["a"],QInput:g["a"],QBtn:q["a"],QDialog:C["a"],QCardActions:b["a"],QInnerLoading:w["a"],QSpinnerGears:Q["a"]}),x()($,"directives",{ClosePopup:S["a"]})}}]);