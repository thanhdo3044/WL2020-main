(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[100],{"904b":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 prodTextTitle q-pa-sm",attrs:{align:"center"}},[t._v("\n            Pallet đang tồn\n        ")])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-md",attrs:{align:"center"}},[a("q-select",{attrs:{options:t.mySources,label:"Công đoạn"},on:{input:t.changeSource},model:{value:t.mySource,callback:function(e){t.mySource=e},expression:"mySource"}})],1)]),t.showFiltterResult?a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("q-card",{staticClass:"my-card bg-secondary text-white",staticStyle:{"margin-left":"20px","margin-right":"20px"}},[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t._v("\n                          Tìm thấy "+t._s(t.numberPalletFound)+" Pallet theo từ khóa "),a("strong",[t._v(t._s(t.quicachSearch))])]),a("div",{staticClass:"col-auto"},[a("q-btn",{attrs:{color:"red",round:"",flat:"",icon:"close"},on:{click:t.removeSearchResult}})],1)])])],1)],1)]):t._e(),t.pallets.length>0?a("div",{staticClass:"row justify-center"},t._l(t.pallets,(function(e){return a("div",{key:e.id,staticClass:"col-12 col-md-3  q-ma-xs q-pa-sm"},[a("card-pallet",{attrs:{pallet:e}},[a("div",{attrs:{slot:"action"},slot:"action"},[a("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.showButtonConfirm,expression:"showButtonConfirm"}],staticStyle:{"font-family":"'Time New Roman'","font-size":"small"},attrs:{outline:"",rounded:"",color:"primary",label:"Xác nhận"},on:{click:function(a){return t.choosePallet(e)}}}),a("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.showButtonTransfer,expression:"showButtonTransfer"}],staticStyle:{"font-family":"'Time New Roman'","font-size":"small"},attrs:{outline:"",rounded:"",color:"primary",label:"Xuất pallet"},on:{click:function(a){return t.transferPallet(e)}}})],1)])],1)})),0):a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col-12 col-md-6 flex flex-center"},[a("p",{staticClass:"text-h4",staticStyle:{"text-align":"center"}},[t._v("Không có dữ liệu !")])])]),a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-fab",{attrs:{icon:"search",color:"accent"},on:{click:t.showSearch}})],1),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:t.showSearchModel,callback:function(e){t.showSearchModel=e},expression:"showSearchModel"}},[a("q-card",{staticStyle:{width:"300px"}},[a("q-card-section",[a("div",{staticClass:"prodTextTitle"},[t._v("Tìm kiếm")])]),a("q-card-section",[a("q-input",{attrs:{outlined:"",label:"Tìm theo qui cách"},on:{input:t.search},model:{value:t.quicachSearch,callback:function(e){t.quicachSearch=e},expression:"quicachSearch"}})],1),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK"}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.showModalDestination,callback:function(e){t.showModalDestination=e},expression:"showModalDestination"}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"row items-center"},[a("div",{staticClass:"text-h6",staticStyle:{"font-family":"'Time'"}},[t._v("Chọn nơi xuất")]),a("q-space")],1),a("q-card-section",[a("q-select",{staticStyle:{"font-family":"'Time New Roman'","font-size":"16px"},attrs:{behavior:"dialog",options:t.listDestinations,label:"Nơi xuất đến :"},model:{value:t.destinationSelect,callback:function(e){t.destinationSelect=e},expression:"destinationSelect"}}),a("br")],1),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đồng ý"},on:{click:t.tranfer}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"transfer_within_a_station",color:"primary","text-color":"white"}}),a("span",{staticClass:"prodTextTitle",staticStyle:{"margin-left":"30px"}},[t._v("Bạn đã chắc chắn ? ")])],1),a("q-card-section",[a("p",{staticStyle:{"font-family":"'Time'"}},[t._v("Xuất pallet sang công đoạn "+t._s(t.destinationSelect?t.destinationSelect.label:""))])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy",color:"danger"}}),a("q-btn",{attrs:{flat:"",label:"Xuất",color:"primary"},on:{click:t.submit}})],1)],1),a("q-inner-loading",{attrs:{showing:t.transferPending}},[a("q-spinner-gears",{attrs:{size:"80px",color:"primary"}})],1)],1)],1)},s=[],i=(a("386d"),a("20d6"),a("6b54"),a("06db"),a("a34a")),o=a.n(i),l=(a("96cf"),a("c973")),c=a.n(l),r=(a("7f7f"),a("f79b")),h=a("dd38"),u=a("d534"),d={components:{"app-bar":h["a"],"card-pallet":u["a"]},beforeCreate:function(){},created:function(){var t=this,e=this.$route.query.type;"tf"===e&&(this.showButtonTransfer=!0),this.typeOf=r["d"],this.$store.getters["base/mySources"].forEach((function(e){t.mySources.push({label:e.code+" - "+e.name,value:e.id})})),this.mySource=this.mySources[0],this.initData(this.mySource.value)},data:function(){return{tab:"one",showSearchModel:!1,quicachSearch:"",pallets:{},numberPalletFound:0,showFiltterResult:!1,showButtonConfirm:!1,showButtonTransfer:!1,showModalDestination:!1,confirm:!1,destiSelect:{},transferPending:!1,pallet:{},listDestinations:[],destinationSelect:null,mySources:[],mySource:null}},methods:{changeSource:function(){var t=this;return c()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.initData(t.mySource.value);case 1:case"end":return e.stop()}}),e)})))()},initData:function(t){var e=this,a={token:"",sourceId:t};this.$store.dispatch("production/ACTION_GET_PALLET_IN_LINE",a).then((function(t){e.pallets=e.$store.state.production.palletsInLine}))},showDes:function(){this.transferPending=!1},submit:function(){var t=this;this.transferPending=!0;var e={data:{sourceId:this.mySource.value,destinationId:this.destinationSelect.value,pass:this.pallet.item[0].quantity,notPass:0},palletCode:this.pallet.code};this.$store.dispatch("production/ACTION_STEP_PALLET",e).then((function(a){if(!0===a.meta.success){t.$q.notify({message:"Xuất pallet thành công !",color:"green"});var n={eventName:"Xuất Pallet",timeStamp:(new Date).toISOString(),status:1,palletCode:t.pallet.code};t.$eventLog(n);var s=t.destinationSelect.value.toString()+"-RECIVED-PALLET",i="Đã nhận được pallet số "+e.palletCode,o="Nhận được pallet từ công đoạn "+t.mySource.name+" chuyển đến công đoạn "+t.destiSelect.name,l="/#/production-detail-pallet/"+e.palletCode;t.$sendFcm(i,o,l,s,{}).then((function(t){console.log(t)})),t.initData()}else t.$q.notify({message:a.meta.messages.message,color:"red"});t.transferPending=!1,t.confirm=!1})).catch((function(e){console.log(e),t.$q.notify({message:e,color:"red"}),t.transferPending=!1,t.confirm=!1}))},tranfer:function(){this.destinationSelect?this.confirm=!0:this.$q.notify({message:"Vui lòng chọn nơi xuất  !",color:"orange"})},transferPallet:function(t){var e=this;this.pallet=t;var a=t.item[0].id,n=this.mySource.value,s=this.$store.getters["base/myDestinations"],i={itemId:a,token:this.$store.state.production.userInfo.token};this.listDestinations=[],this.$store.dispatch("production/ACTION_GET_DESTINATION_BY_ITEM",i).then((function(t){if(t.data.length>0){var a=t.data.findIndex((function(t){return t.id===n}));if(a<t.data.length-1){var s={label:t.data[a+1].name,value:t.data[a+1].id};e.listDestinations.push(s),e.destinationSelect=s}}else e.$q.notify({message:"Không tìm thấy định tuyến cho sản phẩm này !"})})),s.length>0&&s.forEach((function(t){if(-1===e.listDestinations.findIndex((function(e){return e.value===t.id}))){var a={label:t.name,value:t.id};e.listDestinations.push(a)}})),this.showModalDestination=!0},choosePallet:function(t){var e=this,a={palletCode:t.code,token:this.$store.state.production.userInfo.token};this.$store.dispatch("production/ACTION_GET_DETAIL_PALLET",a).then((function(){e.$router.push("/production-comfirm-pallet")}))},search:function(t){var e=this.$store.state.production.palletsInLine.filter((function(e){var a=e.item[0].height.toString()+e.item[0].width.toString()+e.item[0].length.toString();if(-1!==a.toString().search(t))return e}));e.length>0?(this.pallets=e,this.numberPalletFound=e.length,this.showFiltterResult=!0):this.pallets=this.$store.state.production.palletsInLine},showSearch:function(){this.quicachSearch="",this.showSearchModel=!0},removeSearchResult:function(){this.quicachSearch="",this.showSearchModel=!1,this.showFiltterResult=!1,this.pallets=this.$store.state.production.palletsInLine}}},p=d,m=a("2877"),f=a("9989"),v=a("ddd8"),g=a("f09f"),S=a("a370"),w=a("9c40"),y=a("de5e"),b=a("c294"),q=a("24e8"),C=a("27f9"),x=a("4b7e"),T=a("2c91"),_=a("1c1c"),I=a("66e5"),k=a("4074"),P=a("0016"),D=a("cb32"),$=a("74f7"),N=a("cf57"),Q=a("7f67"),E=a("714f"),L=a("eebe"),A=a.n(L),M=Object(m["a"])(p,n,s,!1,null,null,null);e["default"]=M.exports;A()(M,"components",{QPage:f["a"],QSelect:v["a"],QCard:g["a"],QCardSection:S["a"],QBtn:w["a"],QPageSticky:y["a"],QFab:b["a"],QDialog:q["a"],QInput:C["a"],QCardActions:x["a"],QSpace:T["a"],QList:_["a"],QItem:I["a"],QItemSection:k["a"],QIcon:P["a"],QAvatar:D["a"],QInnerLoading:$["a"],QSpinnerGears:N["a"]}),A()(M,"directives",{ClosePopup:Q["a"],Ripple:E["a"]})}}]);