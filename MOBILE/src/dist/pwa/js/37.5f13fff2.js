(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{6906:function(t,e,a){"use strict";var i=a("ee35"),s=a.n(i);s.a},"70b7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-pa-md"},[a("app-bar",[t._v("Nghiệm thu")]),a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-sm-6 q-mt-sm"},[a("q-card",[a("q-card-section",[a("div",{staticClass:"prodTextTitle"},[t._v("\n                        Thông tin chính phẩm\n                    ")])]),a("q-card-section",[a("p",{staticClass:"woodText"},[t._v("- Loại gỗ : "+t._s(t.receipt?t.receipt.WOOD_TYPE:"..."))]),a("p",{staticClass:"woodText"},[t._v("- Tổng số tờ : "+t._s(t.receipt?t.receipt.PCS_PER_PACKAGE*t.receipt.PACKAGE_QUANTITY:"..."))]),a("p",{staticClass:"woodText"},[t._v("- Tổng khối lượng : "+t._s(t.receipt?t.receipt.VOLUMN:"...")+" (m³)")]),a("p",{staticClass:"woodText",staticStyle:{"font-weight":"800","text-align":"center"}},[t._v(t._s(t.receipt?t.receipt.HEIGHT:"")+"*"+t._s(t.receipt?t.receipt.WIDTH:"")+"*"+t._s(t.receipt?t.receipt.LENGTH:""))])])],1)],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-input",{attrs:{outlined:"",type:"number",label:"Số tờ mẫu"},model:{value:t.sampleQty,callback:function(e){t.sampleQty=t._n(e)},expression:"sampleQty"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-input",{attrs:{outlined:"",label:"Tỷ lệ A1",suffix:"%"},model:{value:t.rateA1,callback:function(e){t.rateA1=e},expression:"rateA1"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-input",{attrs:{outlined:"",suffix:"%",label:"Độ ẩm",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.humidity,callback:function(e){t.humidity=e},expression:"humidity"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-input",{attrs:{outlined:"",type:"textarea",label:"Ghi chú",placeholder:"Lẫn keo + tạp màu 2%"},model:{value:t.note,callback:function(e){t.note=e},expression:"note"}})],1)]),a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-separator",{staticClass:"q-mt-sm",attrs:{inset:""}})],1)]),a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-sm-6",attrs:{align:"right"}},[a("span",{staticClass:"fake-link",on:{click:function(e){t.showAdd=!0}}},[t._v("Thêm")])])]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12 col-sm-6"},[a("table",{staticStyle:{width:"100%"}},[a("tr",[a("th",[t._v("Phân loại")]),a("th",[t._v("Kích thước")]),a("th",[t._v("Tình trạng")]),a("th",[t._v("Số lượng")]),a("th",[t._v("Tỷ lệ(%)")]),a("th")]),0===t.inspectArray.length?a("tr",{staticStyle:{"text-align":"center"}},[a("td",{attrs:{colspan:"6"}},[a("span",{staticClass:"fake-link",on:{click:function(e){t.showAdd=!0}}},[t._v("Nhấn để thêm dữ liêu !")])])]):t._l(t.inspectArray,(function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(e.iTypeName))]),a("td",[t._v(t._s(e.itemName))]),a("td",[t._v(t._s(e.dTypeName))]),a("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.defectQty))]),a("td",{staticStyle:{"text-align":"center"}},[t._v(t._s((100*e.payRate).toFixed(2)))]),a("td",[a("span",{staticClass:"fake-link",on:{click:function(e){return t.remove(i)}}},[t._v("Xóa")])])])}))],2)])]),a("div",{staticClass:"row justify-center q-mt-md q-mb-md"},[a("div",{staticClass:"col-12 col-sm-6"},[a("q-btn",{staticClass:"full-width",attrs:{color:"secondary",label:"Lưu lại"},on:{click:function(e){t.confirm=!0}}})],1)]),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm"},[t._v("Bạn đã chắc chắn !.")])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Hủy",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Đồng Ý",color:"primary"},on:{click:t.save}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.showAdd,callback:function(e){t.showAdd=e},expression:"showAdd"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm"},[t._v("Chọn kích thước nghiệm thu")])]),a("q-card-section",[a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12"},[a("q-select",{attrs:{outlined:"",options:t.iTypes,label:"Phận loại"},model:{value:t.itype,callback:function(e){t.itype=e},expression:"itype"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12"},[a("q-select",{attrs:{outlined:"",options:t.dTypes,label:"Tình trạng gỗ"},model:{value:t.dType,callback:function(e){t.dType=e},expression:"dType"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12"},[a("q-select",{attrs:{outlined:"",options:t.items,label:"Kích thước nghiệm thu"},model:{value:t.item,callback:function(e){t.item=e},expression:"item"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12"},[a("q-input",{attrs:{outlined:"",type:"number",label:"Số tấm loại"},model:{value:t.defectQty,callback:function(e){t.defectQty=t._n(e)},expression:"defectQty"}})],1)]),a("div",{staticClass:"row justify-center q-mt-sm"},[a("div",{staticClass:"col-12"},[a("q-input",{attrs:{outlined:"",type:"number",label:"Tỷ lệ loại"},model:{value:t.rateInspect,callback:function(e){t.rateInspect=t._n(e)},expression:"rateInspect"}})],1)])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",label:"Hủy",color:"deep-orange"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",label:"Đồng ý",color:"primary"},on:{click:t.addKT}})],1)],1)],1)],1)},s=[],n=(a("551c"),a("06db"),a("a34a")),c=a.n(n),o=(a("96cf"),a("c973")),r=a.n(o),l=(a("20d6"),a("dd38")),d=a("fa7d"),p={components:{"app-bar":l["a"]},data:function(){return{iTypes:[],itype:null,defectQty:"",sampleQty:0,receipt:null,rateA1:0,sizeRate:!0,sizeOutRate:0,humidity:"",item:null,items:[],confirm:!1,receiptRate:0,dTypes:[],dType:null,rateNonLi:0,showAdd:!1,rateLuonLi:0,inspectArray:[],note:"",noteRateA1:"",noteRateSize:"Chiều dài, chiều rộng đạt",noteRateNonLi:"",noteRateLuonLi:"",noteHieghtRate:"",noteDoAm:"",heightRate:0,rateMc:0,noteRateMc:"",showRateMc:!1,rateInspect:""}},created:function(){this.loadInputType(),this.loadDetailInput(),this.loadDType()},watch:{sizeRate:function(t){console.log(t)},sizeOutRate:function(t){this.noteRateSize=t>0?"Tỷ lệ hụt kích thước "+t+" %":"Chiều dài, chiều rộng đạt",this.loadNote()},rateNonLi:function(t){this.noteRateNonLi=t>0?"Tỷ lệ non li ".concat(t," %"):"",this.loadNote()},rateLuonLi:function(t){this.noteRateLuonLi=t>0?"Tỷ lệ lượn li ".concat(t," %"):"",this.loadNote()},rateA1:function(t){this.noteRateA1=t>0?"Tỷ lệ A1 ".concat(t," %"):"",this.loadNote()},humidity:function(t){t>0?(this.noteDoAm="Độ ẩm ".concat(t," % ")+this.noteRateMc,t>=20?this.showRateMc=!0:(this.showRateMc=!1,this.rateMc=0,this.noteRateMc="")):this.noteDoAm="",this.loadNote()},heightRate:function(t){this.noteHieghtRate=t>0?"Tỷ lệ chiều dầy hụt ".concat(t," %"):"",this.loadNote()},rateMc:function(t){this.noteRateMc=t>0?"(Hạ cấp độ ẩm ".concat(t," %)"):"",this.loadNote()}},methods:{remove:function(t){this.inspectArray.splice(t,1)},loadNote:function(){this.note=this.noteDoAm},addKT:function(){var t=this;if(this.dType&&this.item&&this.itype){var e=this.inspectArray.findIndex((function(e){return e.iTypeId===t.itype.value}));if(-1===e){var a={itemId:this.item.value,itemName:this.item.label,iTypeId:this.itype.value,iTypeName:this.itype.label,dTypeId:this.dType.value,dTypeName:this.dType.label,defectQty:this.defectQty||0,wTypeId:this.receipt.WOOD_TYPE_ID,payRate:this.rateInspect/100||this.defectQty/this.sampleQty};this.inspectArray.push(a),this.defectQty=""}else this.inspectArray[e].defectQty+=this.defectQty}else Object(d["p"])()},changeRate:function(){var t=parseInt(Object(d["k"])(this.receiptRate/100*this.sampleQty,0));this.defectQty=this.sampleQty-t},loadDType:function(){var t=this;return r()(c.a.mark((function e(){var a;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("wood/GET_DTYPE","vcn");case 2:a=e.sent,a.data.forEach((function(e){var a={label:e.NAME,value:e.CODE};t.dTypes.push(a)})),t.dTypes.length>0&&(t.dType=t.dTypes[0]);case 5:case"end":return e.stop()}}),e)})))()},loadDetailInput:function(){var t=this;return r()(c.a.mark((function e(){var a,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.$route.params.id,e.next=3,t.$store.dispatch("wood/GET_DETAIL_DLT",a);case 3:i=e.sent,t.receipt=i.data[0],t.receipt&&(t.sampleQty=(.05*t.receipt.PACKAGE_QUANTITY*t.receipt.PCS_PER_PACKAGE).toFixed(0),t.loadItems());case 6:case"end":return e.stop()}}),e)})))()},save:function(){var t=this;return r()(c.a.mark((function e(){var a,i,s;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$route.params.id,!(a&&t.humidity&&t.inspectArray.length>0)){e.next=9;break}return i={receiptDetailId:a,note:t.note,sizeOutRate:t.sizeOutRate,heightOutRate:t.heightRate,humidity:t.humidity,isDouble:"N",sampleQuantity:t.sampleQty,rateA1:t.rateA1,rateNonLi:t.rateNonLi,rateLuonLi:t.rateLuonLi,arrayInspection:t.inspectArray},e.next=5,t.$store.dispatch("wood/CREATE_INSPECTION",i);case 5:s=e.sent,s.meta.success?(t.$q.notify({message:"Thành công !",color:"green"}),t.$router.go(-1)):t.$q.notify({message:s.meta.message,color:"red"}),e.next=10;break;case 9:Object(d["p"])();case 10:case"end":return e.stop()}}),e)})))()},loadItems:function(){var t=this;return r()(c.a.mark((function e(){var a,i,s,n;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.receipt.XTYPE,a=100010,i={typeId:a},e.next=5,t.$store.dispatch("wood/GET_ITEM_BY_TYPE",i);case 5:s=e.sent,s.data.length>0&&(s.data.forEach((function(e){var a={value:e.id,label:e.height+"*"+e.width+"*"+e.length+" ("+t.receipt.WOOD_TYPE+")"};t.items.push(a)})),n=t.items.findIndex((function(e){return e.value===t.receipt.ITEM_ID})),t.item=t.items[n]);case 7:case"end":return e.stop()}}),e)})))()},loadInputType:function(){var t=this;return new Promise(function(){var e=r()(c.a.mark((function e(a,i){var s,n;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={moduleCode:"vcn",type:"INSPECTION"},e.next=3,t.$store.dispatch("wood/GET_INPUT_TYPE",s);case 3:n=e.sent,n.data.forEach((function(e){var a={label:e.NAME,value:e.ID};t.iTypes.push(a)})),t.iTypes.length>0&&(t.itype=t.iTypes[0]),a(!0);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}}},u=p,h=(a("6906"),a("2877")),m=a("9989"),y=a("f09f"),f=a("a370"),v=a("27f9"),T=a("eb85"),w=a("9c40"),C=a("24e8"),b=a("4b7e"),_=a("ddd8"),g=a("7f67"),q=a("eebe"),A=a.n(q),x=Object(h["a"])(u,i,s,!1,null,"ced7bde6",null);e["default"]=x.exports;A()(x,"components",{QPage:m["a"],QCard:y["a"],QCardSection:f["a"],QInput:v["a"],QSeparator:T["a"],QBtn:w["a"],QDialog:C["a"],QCardActions:b["a"],QSelect:_["a"]}),A()(x,"directives",{ClosePopup:g["a"]})},ee35:function(t,e,a){}}]);