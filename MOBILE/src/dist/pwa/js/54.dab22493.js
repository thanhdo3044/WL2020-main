(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[54],{"7c10":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("order-header",{attrs:{order:e.order}}),a("q-card",{staticClass:"my-card"},[a("BienBanBanGiao",{attrs:{order:e.order,metaValue:e.metaValue,disable:e.disable}})],1),a("q-card",[a("q-card-section",[void 0==e.order.Requests||e.order.Requests&&!Object.keys(e.order.Requests).length?a("q-checkbox",{attrs:{label:"Đồng ý"},model:{value:e.disable,callback:function(t){e.disable=t},expression:"disable"}}):e._e()],1)],1),e.disable?a("order-approved",{attrs:{metaValue:e.metaValue,order:e.order}}):e._e(),a("send-message",{attrs:{order:e.order}})],1)},n=[],o=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("f751"),a("9523")),i=a.n(o),s=a("2f62"),u=a("932a"),c=a("6664"),d=a("0ac8"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card-section",["Không được duyệt"==e.order.status?a("div",[a("div",{staticClass:"text-h6"},[e._v("Chọn người nhận bàn giao:")]),a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md row"},[a("q-select",{staticStyle:{width:"250px","padding-bottom":"32px"},attrs:{filled:"","use-input":"",readonly:!e.disable,"input-debounce":"0",options:e.options,hint:"",label:"Người nhận bàn giao"},on:{input:e.changed,filter:e.filterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                  No results\n                ")])],1)]},proxy:!0}],null,!1,3665793935),model:{value:e.metaValue.accountName,callback:function(t){e.$set(e.metaValue,"accountName",t)},expression:"metaValue.accountName"}})],1)]),a("div",{staticClass:"q-mt-sm"},[e._v("Nội dung bàn giao :")]),a("DxDataGrid",{attrs:{id:"gridContainer","data-source":e.order.OrderMeta,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"word-wrap-enabled":!0},on:{"init-new-row":e.initNewRow,"row-inserted":e.RowInserted,"row-updated":e.RowUpdated,"row-removed":e.RowDelted}},[a("DxPaging",{attrs:{enabled:!0}}),a("DxEditing",{attrs:{"allow-updating":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-deleting":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-adding":!e.order.Requests.length||"Không được duyệt"==e.order.status,mode:"row"}}),a("DxColumn",{attrs:{"data-field":"STT",caption:"STT","data-type":"number"}}),a("DxColumn",{attrs:{caption:"Nội dung","data-field":"mucDichSuDung"}}),a("DxColumn",{attrs:{caption:"Số lượng","data-field":"number","data-type":"number"}}),a("DxColumn",{attrs:{caption:"Ghi chú","data-field":"description"}})],1),a("q-btn",{staticClass:"q-mt-sm",attrs:{color:"primary","text-color":"white",label:"Sửa"},on:{click:e.updatedOrderMeta}})],1):a("div",[a("div",{staticClass:"text-h6"},[e._v("Chọn người nhận bàn giao:")]),a("div",{},[a("div",{staticClass:"row"},[a("q-select",{staticStyle:{width:"250px","padding-bottom":"32px"},attrs:{filled:"","use-input":"",readonly:e.disable,"input-debounce":"0",options:e.options,hint:"",label:"Người nhận bàn giao"},on:{input:e.changed,filter:e.filterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                  No results\n                ")])],1)]},proxy:!0}]),model:{value:e.metaValue.accountName,callback:function(t){e.$set(e.metaValue,"accountName",t)},expression:"metaValue.accountName"}}),null!=e.order.OrderMeta?a("div",[e._v("Người đã chọn bàn giao: "+e._s(e.order.OrderMeta[0].fullName2))]):e._e()],1)]),a("div",[e._v("Nội dung bàn giao :")]),a("DxDataGrid",{attrs:{id:"gridContainer","data-source":e.order.OrderMeta,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"word-wrap-enabled":!0,onEditingStart:e.Start},on:{"init-new-row":e.initNewRow,"row-inserted":e.RowInserted,"row-updated":e.RowUpdated,"row-removed":e.RowDelted}},[a("DxPaging",{attrs:{enabled:!0}}),a("DxEditing",{attrs:{"allow-updating":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-deleting":!e.order.Requests.length||"Không được duyệt"==e.order.status,"allow-adding":!e.order.Requests.length||"Không được duyệt"==e.order.status,mode:"row"}}),a("DxColumn",{attrs:{"data-field":"STT",caption:"STT","data-type":"number"}}),a("DxColumn",{attrs:{caption:"Nội dung","data-field":"mucDichSuDung"}}),a("DxColumn",{attrs:{caption:"Số lượng","data-field":"number","data-type":"number"}}),a("DxColumn",{attrs:{caption:"Ghi chú","data-field":"description"}})],1)],1)])},p=[],m=(a("6b54"),a("a34a")),g=a.n(m),b=(a("96cf"),a("c973")),h=a.n(b),f=a("6191"),w=a.n(f),O=a("bc3a"),v=a.n(O),x=a("2a19"),D=(a("f508"),a("d9b2"),a("d30a"));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S={components:{DxDataGrid:D["DxDataGrid"],DxColumn:D["DxColumn"],DxEditing:D["DxEditing"],DxPaging:D["DxPaging"],DxButton:w.a,DxLookup:D["DxLookup"]},props:["metaValue","disable","order"],created:function(){var e=this;return h()(g.a.mark((function t(){return g.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.accounts.map((function(e){return{label:e.lastName,value:e.id,description:e.position}}));case 2:e.account=t.sent,console.log("this.account",e.accounts);case 4:case"end":return t.stop()}}),t)})))()},data:function(){var e;return e={events:[],nameDepartment:{},status:"",phoneNumber:""},i()(e,"nameDepartment",null),i()(e,"events",[]),i()(e,"options",null),i()(e,"account",null),e},computed:N(N({},Object(s["c"])("orders",["order","accounts"])),Object(s["c"])("base",["userInfo","dsCongDoans"])),methods:N(N(N(N(N({},Object(s["b"])("base",["GET_DEPARTMENTSBYID"])),Object(s["b"])("orders",["getOneOrder","getAllRequests"])),Object(s["b"])("orderMetas",["getOneOrderMeta","addorderMeta","deleteOrderMeta","updateOrderMeta"])),Object(s["b"])("requests",["deleteRequest","resetOrder"])),{},{Start:function(e){var t=this;return h()(g.a.mark((function e(){return g.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.metaValue.accountName||x["a"].create({message:"Vui lòng chọn người nhận bàn giao !",color:"blue"});case 1:case"end":return e.stop()}}),e)})))()},loadData:function(e){var t=this;return h()(g.a.mark((function a(){var r;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=null,a.prev=1,a.next=4,t.getOneOrder(e);case 4:r=a.sent,a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](1),console.log(a.t0);case 10:r||t.$router.push({path:"/tao-de-xuat"}),t.order=r.data.data,console.log(r);case 13:case"end":return a.stop()}}),a,null,[[1,7]])})))()},RowInserted:function(e){var t=this;return h()(g.a.mark((function a(){var r,n,o,i,s,u,c,d,l;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),r=e.data.STT,n=t.userInfo.lastName,o=e.data.number,i=e.data.description,s=t.userInfo.PHONE,u=t.order.OrderMeta[0].selection,c=e.data.mucDichSuDung,d=t.metaValue.accountName.label,l=t.metaValue.accountName.value.toString(),a.next=12,t.addorderMeta(N(N({},t.order.OrderMeta[0]),{},{metaValue:JSON.stringify([]),selection:u,STT:r,fullName:n,number:o,description:i,phoneNumber:s,mucDichSuDung:c,fullName2:d,maNV:l}));case 12:return a.next=14,t.loadData(t.$route.query.id);case 14:case"end":return a.stop()}}),a)})))()},RowDelted:function(e){var t=this;return h()(g.a.mark((function a(){return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),a.next=3,t.deleteOrderMeta(e.data.id);case 3:case"end":return a.stop()}}),a)})))()},RowUpdated:function(e){var t=this;return h()(g.a.mark((function a(){var r,n,o,i,s,u,c,d,l;return g.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),r=e.data.STT,n=t.userInfo.lastName,o=e.data.number,i=e.data.description,s=t.userInfo.PHONE,u=t.order.OrderMeta[0].selection,c=e.data.mucDichSuDung,d=t.metaValue.accountName.label,l=t.metaValue.accountName.value.toString(),a.next=12,t.updateOrderMeta(N(N({},t.order.OrderMeta[0]),{},{metaValue:JSON.stringify([]),selection:u,STT:r,fullName:n,number:o,description:i,phoneNumber:s,mucDichSuDung:c,fullName2:d,maNV:l}));case 12:return a.next=14,t.loadData(t.$route.query.id);case 14:case"end":return a.stop()}}),a)})))()},filterFn:function(e,t){var a=this;t(""!==e?function(){var t=e.toLowerCase();a.options=a.account.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}:function(){a.options=a.account})},updatedOrderMeta:function(){var e=this;return h()(g.a.mark((function t(){var a,r;return g.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.metaValue.accountName.label,r=e.metaValue.accountName.value.toString(),t.next=4,e.updateOrderMeta(N(N({},e.order.OrderMeta[0]),{},{metaValue:JSON.stringify([]),fullName2:a,maNV:r}));case 4:return t.next=6,v.a.put("/api/v2/orders?orderId=".concat(e.order.id));case 6:return t.next=8,e.deleteRequest(e.order.id);case 8:location.reload();case 9:case"end":return t.stop()}}),t)})))()},initNewRow:function(e){var t=e.data;console.log("vao initNewRow"),Object.assign(t,{STT:this.order.OrderMeta.length+1})}})},j=S,q=a("2877"),C=a("a370"),T=a("ddd8"),R=a("66e5"),V=a("4074"),M=a("9c40"),k=a("eebe"),P=a.n(k),_=Object(q["a"])(j,l,p,!1,null,null,null),E=_.exports;function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}P()(_,"components",{QCardSection:C["a"],QSelect:T["a"],QItem:R["a"],QItemSection:V["a"],QBtn:M["a"]});var B={data:function(){return{disable:!1,metaValue:{kinhGui:"Ban TGĐ - Trưởng phòng/phó phòng ban :  -\tGĐSX/Phó GĐSX/Phụ trách nhà máy :",noiDungTT:"",soTien:0,vietBangChu:"",kemTheo:"",STT:"12",locationWork:"",position:"",position2:"",number:"",timeRecruit:"",description:"",fullName:"",fullName2:"",maNV:"",department:"",department2:"",stepDepartment:"",lyDo:"",dateStart:"",dateEnd:"",selection1:null,selection2:null,selection3:null,selection4:null,selection:null,thoiGianMangThai:"",xinRaCong:"",luongHienTai:"",luongDeXuat:"",thoiGianTangLuongGanNhat:"",phoneNumber:"",accountName:""}}},components:{SendMessage:u["a"],OrderHeader:c["a"],OrderApproved:d["a"],BienBanBanGiao:E},methods:I(I({},Object(s["b"])("orders",["getOneOrder","getAllRequests"])),Object(s["b"])("orderMetas",["getOneOrderMeta","addorderMeta"])),computed:I(I({},Object(s["c"])("orders",["order"])),Object(s["c"])("base",["userInfo","myFactoryInfor"])),created:function(){var e=this;this.$route.query.id?this.getOneOrder(this.$route.query.id).then((function(t){t.data.data.Requests.length&&(e.disable=!0),e.metaValue=Object.assign(e.metaValue,JSON.parse(t.data.data.OrderMeta[0].metaValue)[0])})):this.$router.push({path:"/tao-de-xuat"})}},$=B,Q=a("9989"),K=a("f09f"),J=a("8f8e"),L=Object(q["a"])($,r,n,!1,null,null,null);t["default"]=L.exports;P()(L,"components",{QPage:Q["a"],QCard:K["a"],QCardSection:C["a"],QCheckbox:J["a"]})}}]);