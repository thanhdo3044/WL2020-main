(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[123],{6990:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{attrs:{padding:""}},[n("list-header",{attrs:{bgcolor:"bg-green-4"}},[t._v("Cấp phôi")]),n("q-select",{attrs:{filled:"","use-input":"","input-debounce":"0",label:"Chọn lệnh sản xuất",options:t.options,behavior:"menu",dense:""},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[t._v("\n          No results\n        ")])],1)]},proxy:!0}]),model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),n("q-select",{attrs:{filled:"",label:"Chọn công đoạn",options:t.getStepsByNumber(t.model),"emit-value":"","map-options":"",behavior:"menu",dense:""},scopedSlots:t._u([{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[t._v("\n          No results\n        ")])],1)]},proxy:!0}]),model:{value:t.step,callback:function(e){t.step=e},expression:"step"}}),t.pos.length?n("div",t._l(t.pos,(function(e){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,class:"bg-orange-1",attrs:{clickable:""},on:{click:function(n){return t.showManHinhCapPhoi(e)}}},[n("q-item-section",[n("q-item-label",{staticClass:"text-subtitle2"},[t._v("\n          ["+t._s(e.Item.code)+"] - "+t._s(e.Item.name)+" ("+t._s(e.itemHeight)+"*"+t._s(e.Item.width)+"*"+t._s(e.Item.length)+")\n        ")]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[n("span",{staticClass:"q-badge flex inline items-center no-wrap q-badge--single-line bg-teal"},[t._v(t._s(e.number.toUpperCase())+t._s(e.market?" * "+e.root:""))])])],1),n("q-item-section",{attrs:{side:"",top:""}},[n("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.moment(e.ngayDongGoi).subtract(Math.ceil(e.thoiGianBatDau+ +e.thoiGianCho),"days").format("L")))]),n("q-badge",{attrs:{color:"teal",label:e.keHoach-e.ton}})],1)],1)})),1):t._e(),n("q-dialog",{model:{value:t.card,callback:function(e){t.card=e},expression:"card"}},[t.task?n("q-card",{staticClass:"my-card"},[n("q-card-section",[n("div",{staticClass:"row no-wrap items-center"},[n("div",{staticClass:"col text-h6 ellipsis"},[t._v("\n            "+t._s(t.task.number)+"\n          ")]),n("div",{staticClass:"col-auto text-grey text-caption q-pt-md row no-wrap items-center"},[t._v("\n            Kế hoạch: "+t._s(t.task.keHoach-t.task.ton)+"\n          ")])])]),n("q-card-section",{staticClass:"q-pt-none"},[n("div",{staticClass:"text-subtitle1"},[t._v("\n          ["+t._s(t.task.Item.code)+"] - "+t._s(t.task.Item.name)+" ("+t._s(t.task.itemHeight)+"*"+t._s(t.task.Item.width)+"*"+t._s(t.task.Item.length)+")\n        ")]),n("q-badge",{attrs:{color:"secondary"}},[t._v("\n          Số lượng cấp: "+t._s(t.standard)+" (0 to "+t._s(t.task.keHoach-t.task.ton)+")\n        ")]),n("q-input",{attrs:{outlined:"",label:"Số lượng cấp"},model:{value:t.standard,callback:function(e){t.standard=e},expression:"standard"}}),n("q-slider",{attrs:{min:0,max:t.task.keHoach-t.task.ton},model:{value:t.standard,callback:function(e){t.standard=e},expression:"standard"}})],1),n("q-card-section",[n("div",{staticClass:"text-caption text-grey"},[t._v("\n          Tổng khối lượng có thể cấp:\n          "),n("q-badge",{attrs:{color:"secondary"}},[t._v("\n            "+t._s(t.tongPhoi)+"\n          ")])],1),t.nguonPhois?n("q-list",t._l(t.nguonPhois,(function(e){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.nguonPhoi,attrs:{tag:"label"}},[n("q-item-section",{attrs:{avatar:""}},[n("q-checkbox",{attrs:{val:"teal",color:"teal",disable:!1}})],1),n("q-item-section",[n("q-item-label",[t._v(t._s(e.nguonPhoi))]),n("q-item-label",{attrs:{caption:""}},[t._v("Còn tồn: "+t._s(e.quantity))])],1)],1)})),1):t._e()],1),n("q-separator"),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Hủy"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"Đồng ý",disable:!t.standard},on:{click:t.xacNhapTruKeHoach}})],1)],1):t._e()],1)],1)},s=[],o=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("a34a")),r=n.n(o),i=(n("96cf"),n("c973")),c=n.n(i),l=n("9523"),u=n.n(l),p=n("2f62"),d=n("2831");function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={data:function(){return{model:null,options:[],steps:[],step:null,card:!1,color:["teal"],standard:2.535,task:null,nguonPhois:[]}},computed:h(h(h({},Object(p["c"])("po",["numbers","getStepsByNumber","pos"])),Object(p["c"])("base",["userInfo"])),{},{tongPhoi:function(){return this.nguonPhois.reduce((function(t,e){return e.quantity+t}),0)}}),methods:h(h({},Object(p["b"])("po",["getAllLsx","getPosByNumberAndStep","getAllNguonPhoi","resetPos","themTonKeHoach"])),{},{showManHinhCapPhoi:function(t){var e=this;return c()(r.a.mark((function n(){var a;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getAllNguonPhoi(t);case 2:a=n.sent,e.nguonPhois=a,e.task=t,e.card=!0,e.standard=0,console.log(t);case 8:case"end":return n.stop()}}),n)})))()},xacNhapTruKeHoach:function(){var t=this;return c()(r.a.mark((function e(){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.standard>t.task.keHoach-t.task.ton)){e.next=3;break}return t.$q.dialog({title:"Lỗi",message:"Cấp phôi vượt quá kế hoạch!"}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){})),e.abrupt("return");case 3:if(!(t.standard>t.tongPhoi)){e.next=6;break}return t.$q.dialog({title:"Lỗi",message:"Không tìm thấy nguồn phôi để cấp!"}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){})),e.abrupt("return");case 6:if(t.standard){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.themTonKeHoach({code:t.task.code,quantity:t.standard,createdBy:t.userInfo.id});case 10:t.getPosByNumberAndStep({stepId:t.step,number:t.model}),t.card=!1;case 12:case"end":return e.stop()}}),e)})))()},filterFn:function(t,e){var n=this;e(""!==t?function(){var e=t.toLowerCase();n.options=n.numbers.filter((function(t){return t.toLowerCase().indexOf(e)>-1}))}:function(){n.options=n.numbers})}}),created:function(){this.getAllLsx()},mounted:function(){this.options=this.numbers},watch:{step:function(t){t&&this.getPosByNumberAndStep({stepId:t,number:this.model})},model:function(){this.step=null,this.resetPos()}},components:{ListHeader:d["default"]}},f=b,g=n("2877"),v=n("9989"),k=n("ddd8"),q=n("66e5"),_=n("4074"),y=n("0170"),w=n("58a8"),x=n("24e8"),C=n("f09f"),P=n("a370"),O=n("27f9"),I=n("c1d0"),Q=n("1c1c"),S=n("8f8e"),j=n("eb85"),H=n("4b7e"),N=n("9c40"),L=n("714f"),B=n("7f67"),D=n("eebe"),A=n.n(D),K=Object(g["a"])(f,a,s,!1,null,null,null);e["default"]=K.exports;A()(K,"components",{QPage:v["a"],QSelect:k["a"],QItem:q["a"],QItemSection:_["a"],QItemLabel:y["a"],QBadge:w["a"],QDialog:x["a"],QCard:C["a"],QCardSection:P["a"],QInput:O["a"],QSlider:I["a"],QList:Q["a"],QCheckbox:S["a"],QSeparator:j["a"],QCardActions:H["a"],QBtn:N["a"]}),A()(K,"directives",{Ripple:L["a"],ClosePopup:B["a"]})}}]);